<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.0"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>WebDog</title><meta property="og:type" content="blog"><meta property="og:title" content="WebDog"><meta property="og:url" content="http://yoursite.com/"><meta property="og:site_name" content="WebDog"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://yoursite.com/img/og_image.png"><meta property="article:author" content="WebDog"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://yoursite.com"},"headline":"WebDog","image":["http://yoursite.com/img/og_image.png"],"author":{"@type":"Person","name":"WebDog"},"description":""}</script><link rel="alternative" href="/atom.xml" title="WebDog" type="application/atom+xml"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="WebDog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/webysx"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-02-04T08:05:40.000Z" title="2020-02-04T08:05:40.000Z">2020-02-04</time><span class="level-item"><a class="link-muted" href="/categories/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/">php代码审计</a></span><span class="level-item">18 分钟 读完 (大约 2745 个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/00%E6%88%AA%E6%96%AD/">00截断</a></h1><div class="content"><h1 id="00截断——文件上传"><a href="#00截断——文件上传" class="headerlink" title="00截断——文件上传"></a>00截断——文件上传</h1><p><strong>原理分析：</strong></p>
<blockquote>
<p>0x00是十六进制数，表示ASCII码为0的字符，也是字符串的结束标识符。攻击者可以利用手动添加结束标识符（0x00或%00）来截断上传的内容，从而绕过客户端或服务器的检测，上传非法文件。</p>
</blockquote>
<p><strong>条件：</strong></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1<span class="selector-class">.php</span>版本小于5<span class="selector-class">.3</span><span class="selector-class">.4</span>；</span><br><span class="line">2<span class="selector-class">.php</span><span class="selector-class">.ini</span>文件中的<span class="selector-tag">magic_quotes_gpc</span>设置为<span class="selector-tag">off</span>。</span><br></pre></td></tr></table></figure>

<p><img src="/00%E6%88%AA%E6%96%AD/12.png" alt="12"></p>
<p><strong>注：</strong></p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">一般将<span class="number">00</span>截断分为<span class="number">0x00</span>截断和%<span class="number">00</span>截断两种，实际上两种截断的本质是一样的，%<span class="number">00</span>经过url解码后就变成<span class="number">0x00</span>。所以说%<span class="number">00</span>适合于<span class="keyword">get</span>方法，可直接在添加在url中，经过url解码后就变成<span class="number">0x00</span>；<span class="number">0x00</span>适合于post方法，可通过直接修改文件的二进制文件，添加<span class="number">00</span>即可，因为二进制<span class="number">00</span>与十六进制<span class="number">0x00</span>都表示<span class="number">0</span>。</span><br></pre></td></tr></table></figure>



<h2 id="一、-00截断-upload-labs-master-Pass-12"><a href="#一、-00截断-upload-labs-master-Pass-12" class="headerlink" title="一、%00截断(upload-labs-master/Pass-12)"></a>一、%00截断(upload-labs-master/Pass-12)</h2><blockquote>
<p>%00截断一般是在url中直接使用%00截断，%00在被浏览器进行urldecode操作后变成0x00，最终传入PHP函数执行截断操作。</p>
</blockquote>
<p><strong>源码分析：</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    $ext_arr = <span class="keyword">array</span>(<span class="string">'jpg'</span>,<span class="string">'png'</span>,<span class="string">'gif'</span>); <span class="comment">//创建白名单</span></span><br><span class="line">    $file_ext = substr($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>],strrpos($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>],<span class="string">"."</span>)+<span class="number">1</span>); <span class="comment">//截取后缀</span></span><br><span class="line">    <span class="keyword">if</span>(in_array($file_ext,$ext_arr))&#123; <span class="comment">//检查后缀</span></span><br><span class="line">        $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>]; <span class="comment">//获得临时文件名</span></span><br><span class="line">        $img_path = $_GET[<span class="string">'save_path'</span>].<span class="string">"/"</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">"YmdHis"</span>).<span class="string">"."</span>.$file_ext; <span class="comment">//使用随机数改写文件名和文件路径进行防御</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file($temp_file,$img_path))&#123; <span class="comment">//将文件存入设定的路径</span></span><br><span class="line">            $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'上传出错！'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">        $msg = <span class="string">"只允许上传.jpg|.png|.gif类型文件！"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>首先PHP代码接收到上传的表单信息，然后截取文件后缀，并进行白名单检查，最后将上传的文件存入服务器。这里导致00截断的原因是<code>$img_path = $_GET[&#39;save_path&#39;].&quot;/&quot;.rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext;</code>这行代码没有对<code>save_path</code>进行检测，直接拼接到路径中，导致可以直接修改变量<code>save_path</code>的值，进而利用00截断绕过使用随机数改写文件名和文件路径的防御。</p>
<p><strong>漏洞复现：</strong></p>
<ol>
<li>正常上传，查看上传后的路径，发现是直接拼接<code>save_path</code>；</li>
</ol>
   <img src="/00%E6%88%AA%E6%96%AD/2.png" alt="2" style="zoom:150%;">

   <img src="/00%E6%88%AA%E6%96%AD/1.png" alt="1" style="zoom:150%;">

<ol start="2">
<li><p>修改<code>save_path</code>，利用%00截断绕过，上传webshell木马文件；</p>
<p><img src="/00%E6%88%AA%E6%96%AD/3.png" alt="3"></p>
<p><img src="/00%E6%88%AA%E6%96%AD/4.png" alt="4"></p>
</li>
</ol>
<h2 id="二、0x00截断-upload-labs-master-Pass-13"><a href="#二、0x00截断-upload-labs-master-Pass-13" class="headerlink" title="二、0x00截断(upload-labs-master/Pass-13)"></a>二、0x00截断(upload-labs-master/Pass-13)</h2><blockquote>
<p>0x00截断一般是修改post的二进制文件，将对应字符的十六进制（或二进制）编码改为00，从而起到截断的作用。</p>
</blockquote>
<p><strong>源码分析：</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    $ext_arr = <span class="keyword">array</span>(<span class="string">'jpg'</span>,<span class="string">'png'</span>,<span class="string">'gif'</span>);</span><br><span class="line">    $file_ext = substr($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>],strrpos($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>],<span class="string">"."</span>)+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span>(in_array($file_ext,$ext_arr))&#123;</span><br><span class="line">        $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">        $img_path = $_POST[<span class="string">'save_path'</span>].<span class="string">"/"</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">"YmdHis"</span>).<span class="string">"."</span>.$file_ext;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file($temp_file,$img_path))&#123;</span><br><span class="line">            $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">"上传失败"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = <span class="string">"只允许上传.jpg|.png|.gif类型文件！"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里除了使用post方式上传变量<code>save_path</code>外，其他的基本与一中的相同。漏洞产生的原因还是直接拼接文件路径。</p>
<p><strong>漏洞复现：</strong></p>
<ol>
<li><p>正常上传，查看上传后的路径，发现是直接拼接<code>save_path</code>；</p>
<img src="/00%E6%88%AA%E6%96%AD/6.png" alt="6" style="zoom:150%;">

<img src="/00%E6%88%AA%E6%96%AD/5.png" alt="5" style="zoom:150%;">
</li>
<li><p>这里要注意变量<code>save_path</code>是post方式，所以要修改post文件的十六进制文件的内容。这里不能直接在post文件的<code>../upload/</code>后面直接加<code>webshell.php00</code>，因为此时的0是一个字符，有对应的十六进制编码<code>0x30</code>，可见输入00最后传入服务器的内容为<code>0x30</code>，而不是<code>0x00</code>，所以不能起到截断作用，必须要在十六进制文件中修改；首先在<code>../upload/</code>后面添加<code>webshell.php</code>(注意最后面有一个空格)，空格的十六进制编码为0x20；</p>
<p><img src="/00%E6%88%AA%E6%96%AD/7.png" alt="7"></p>
<p>打开十六进制文件，修改空格位置对应的十六进制编码为00；</p>
<p><img src="/00%E6%88%AA%E6%96%AD/8.png" alt="8"></p>
</li>
</ol>
<p>   <img src="/00%E6%88%AA%E6%96%AD/9.png" alt="9"></p>
<p>   <img src="/00%E6%88%AA%E6%96%AD/10.png" alt="10"></p>
<ol start="3">
<li><p>修改好后直接<code>Forward</code>，上传文件。</p>
<p><img src="/00%E6%88%AA%E6%96%AD/11.png" alt="11"></p>
</li>
</ol>
<p><strong>思考：</strong></p>
<p>在<code>$img_path = $_GET[&#39;save_path&#39;].&quot;/&quot;.rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext;</code>和<code>$img_path = $_POST[&#39;save_path&#39;].&quot;/&quot;.rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext;</code>这两行代码中，都在<code>save_path</code>后面加一个<code>&quot;/&quot;</code>，这里我还不是很清楚反斜杠的作用。但当直接在<code>../upload/</code>后面直接添加<code>webshell.php</code>而没有进行截断时，就会发生上传错误，此时路径会变成<code>../upload/webshell.php/···</code>，上传过程中找不到路径从而导致错误发生。我觉得这也可以作为一种防御方法，在修改的内容的后面（%00之前）加上一个反斜杠，导致文件路径丢失，发生错误，无法上传非法文件，而且浏览器对url中的多个反斜杠会忽略。</p>
<h2 id="三、深入理解00截断"><a href="#三、深入理解00截断" class="headerlink" title="三、深入理解00截断"></a>三、深入理解00截断</h2><p>0x00和%00最后都会被解析为<code>chr(0)</code>，<code>chr()</code>是一个函数，参数是ASCII码，返回值为参数的ASCII码对应的字符。<code>chr(0)</code>的返回值为NULL，即空字符。截断的关键就在于空字符NULL，如果一个字符串中存在空字符，在被php解析的时候会导致空字符后面的字符串被丢弃。这种情况会出现在php(版本&lt;5.3.4)中，这也就解释了为什么00截断的条件要求php版本小于5.3.4。</p>
<table>
<thead>
<tr>
<th>ASCII字符</th>
<th>描述</th>
<th>URL编码</th>
<th>十六进制代码</th>
</tr>
</thead>
<tbody><tr>
<td>NUL</td>
<td>null字符，空字符</td>
<td>%00</td>
<td>00</td>
</tr>
</tbody></table>
<h2 id="四、再探-00"><a href="#四、再探-00" class="headerlink" title="四、再探%00"></a>四、再探%00</h2><p><strong>注意：</strong>在使用%00进行截断时，不能直接将%00加在文件名中。因为PHP函数会对文件的后缀进行提取，然后再进行检测。如果文件名是<code>webshell.php%00webshell.jpg</code>，那么截取后缀的函数就会在%00处停止，所以后缀就为<code>.php</code>，而不是<code>.jpg</code>，从而导致文件不能上传。%00使用的场景还要视具体的情况而定。上面举的例子是由于后端php源码中没有检查<code>$_GET[&#39;save_path&#39;]</code>，所以可以修改<code>save_path</code>的内容，使用%00绕过。</p>
<p><strong>%00是否需要进行urldecode操作？</strong></p>
<p>其实使用%00必须要进行url解码。</p>
<p>在使用post方法上传文件（要与post传参区分开）时，需要创建一个表单来支持文件上传，也就是使用表单来实现文件上传。表单内容：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- The data encoding type, enctype, MUST be specified as below --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">enctype</span>=<span class="string">"multipart/form-data"</span> <span class="attr">action</span>=<span class="string">"__URL__"</span> <span class="attr">method</span>=<span class="string">"POST"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- MAX_FILE_SIZE must precede the file input field --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"MAX_FILE_SIZE"</span> <span class="attr">value</span>=<span class="string">"30000"</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Name of input element determines name in $_FILES array --&gt;</span></span><br><span class="line">    Send this file: <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"userfile"</span> <span class="attr">type</span>=<span class="string">"file"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"Send File"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>#表单中的_<em>URL_</em> 应该被换掉，指向一个真实的 PHP 文件。</p>
<p><code>enctype=&quot;multipart/form-data&quot;</code>：<code>enctype</code>，即<code>encodetype</code>，是编码类型的意思；<code>multipart/form-data</code>是指表单数据由多部分构成，既有文本数据，又有文件等二进制数据。默认情况下，<code>enctype</code>的值是<code>application/x-www-form-urlencoded</code>，不能用于文件上传，只有当值设定为<code>multipart/form-data</code>，才能完整的传递文件数据。<code>application/x-www-form-urlencoded</code>不是不能上传文件，而是只能上传文本格式的文件，上传其他类型的文件时可能会导致文件损坏，数据丢失等等；<code>multipart/form-data</code>是将文件以二进制的形式上传，从而可以实现多种类型的文件上传。表单如果支持上传文件，则还必须附加二进制数据并将其与表单数据分开。 </p>
<p>当设置<code>enctype=&quot;multipart/form-data&quot;</code>时，表示请求主体内容不做url编码，直接原文传输。在一中，参数附在url中，所以要使用%00（即ASCII字符中的NULL字符的url编码）来进行阶段，因为浏览器此时不会进行url编码，数据传到服务器后，服务器会对url进行解码，然后再将解码后的内容传入php文件。所以php接收到的是0x00（NULL），而不是%00。要注意的是，浏览器只会在必要的时候进行URL编码，不会进行URL解码，所有的url都是在服务器上进行urldecode操作的。而在二中，情况就会有所不同。</p>
<p>二中post传递的参数<code>save_path</code>是放在HTTP请求主体内容中，不像一中是放在url中，所以服务器不会对其进行url解码，也就是说不能直接使用%00来截断，只能在对应的十六进制文件中修改。如果直接在根目录<code>../upload/</code>后面加NUL，不能起到截断作用，因为NUL会被当成三个字符，而不是单个字符，所以必须要修改十六进制代码才行。如果要在二中使用%00，就需要先进行url解码才可以起到截断作用。</p>
<p><strong>在二中使用%00截断：</strong></p>
<ol>
<li><p>burpsuite的Decoder模块提供了解码功能。首先使用bp抓包，修改变量<code>save_path</code>的值，然后右键，Send to Decoder;</p>
<p><img src="/00%E6%88%AA%E6%96%AD/13.png" alt="13"></p>
</li>
<li><p>然后进入Decode模块，选择解码方式为URL，进行解码；</p>
<p><img src="/00%E6%88%AA%E6%96%AD/14.png" alt="14"></p>
</li>
<li><p>将解码后的内容复制到Proxy模块中，然后Forward；</p>
<p><img src="/00%E6%88%AA%E6%96%AD/15.png" alt="15"></p>
<p><img src="/00%E6%88%AA%E6%96%AD/16.png" alt="16"></p>
</li>
<li><p>上传成功。</p>
<img src="/00%E6%88%AA%E6%96%AD/17.png" alt="17" style="zoom:150%;">



</li>
</ol>
<h1 id="00截断——代码审计"><a href="#00截断——代码审计" class="headerlink" title="00截断——代码审计"></a>00截断——代码审计</h1><p><strong>原理分析：</strong></p>
<blockquote>
<p>一些PHP函数在读取到0x00（指ASCII码为0 的字符，空字符）时，会自动停止，空字符后面的内容会被忽略。所以可以使用00截断来绕过函数的检测，进行非法操作。</p>
</blockquote>
<p><strong>实例（bugku-ereg正则%00截断）：</strong></p>
<p><a href="https://ctf.bugku.com/challenges#ereg%E6%AD%A3%E5%88%99%00%E6%88%AA%E6%96%AD"> https://ctf.bugku.com/challenges#ereg正则截断 </a></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//题目源码</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$flag = <span class="string">"xxx"</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span> ($_GET[<span class="string">'password'</span>]))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (ereg (<span class="string">"^[a-zA-Z0-9]+$"</span>, $_GET[<span class="string">'password'</span>]) === <span class="keyword">FALSE</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">You password must be alphanumeric</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (strlen($_GET[<span class="string">'password'</span>]) &lt; <span class="number">8</span> &amp;&amp; $_GET[<span class="string">'password'</span>] &gt; <span class="number">9999999</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (strpos ($_GET[<span class="string">'password'</span>], <span class="string">'*-*'</span>) !== <span class="keyword">FALSE</span>) <span class="comment">//strpos — 查找字符串首次出现的位置</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">'Flag: '</span> . $flag);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span>(<span class="string">'</span></span><br><span class="line"><span class="string">*-* have not been found</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">'</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'</span></span><br><span class="line"><span class="string">Invalid password</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">'</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>分析：</strong></p>
<p><code>ereg</code>正则限制了<code>password</code>的值只能为一个或多个大小写字母，数字；</p>
<p><code>password</code>的长度要小于8，而且要大于9999999；</p>
<p><code>strpos</code>查找并返回一个字符串在另一个字符串中出现的位置（区分大小写），<code>password</code>中必须要出现<code>*-*</code>才能getflag；</p>
<p><strong>绕过：</strong></p>
<p>利用00截断绕过<code>ereg</code>正则，并添加<code>&#39;-&#39;</code>；</p>
<p>利用科学计数法绕过长度限制；</p>
<p><strong>payload:</strong></p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span><span class="comment">//123.206.87.240:9009/5.php?password=1e8%00*-*</span></span><br></pre></td></tr></table></figure>

<img src="/00%E6%88%AA%E6%96%AD/18.png" alt="18">

<p><strong>注：%00的长度为1</strong></p>
<p>%00经过url解码后，其十六进制代码为00，变成二进制就是00000000，占八位（一字节），所以长度为1。</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-02-04T08:05:11.000Z" title="2020-02-04T08:05:11.000Z">2020-02-04</time><span class="level-item"><a class="link-muted" href="/categories/sql%E6%B3%A8%E5%85%A5/">sql注入</a></span><span class="level-item">14 分钟 读完 (大约 2046 个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5%E5%92%8C%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5/">宽字节注入和二次注入</a></h1><div class="content"><h1 id="宽字节注入和二次注入"><a href="#宽字节注入和二次注入" class="headerlink" title="宽字节注入和二次注入"></a>宽字节注入和二次注入</h1><h2 id="一、宽字节注入"><a href="#一、宽字节注入" class="headerlink" title="一、宽字节注入"></a>一、宽字节注入</h2><p><strong>背景知识：</strong></p>
<ol>
<li><p>宽窄字节介绍：</p>
<p>窄字节是指大小为一个字节的字符；</p>
<p>宽字节是指大小为两个字节的字符；</p>
<p>默认一个英文字符占一字节，一个汉字占两字节；</p>
<p>常见的宽字节编码：<code>GBK,GB2312,GB18130,BIG5,Shift_JIS</code>等。</p>
</li>
<li><p>相关函数（在代码审计的时候可以检查此类函数）：</p>
<p><code>addslashes()</code>：函数在预定义字符前添加反斜杠，并返回修改后的字符串；主要作用是转义特殊字符；</p>
<p><code>mysql_real_escape_string()</code>：函数转义SQL语句中的特殊字符；</p>
<p><code>mysql_escape_string()</code>：函数转义一个字符串。</p>
</li>
<li><p>编码设置：</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> NAMES <span class="comment">gbk</span></span><br></pre></td></tr></table></figure>

<p>相当于</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span></span><br><span class="line">character_set_client = <span class="string">'gbk'</span>, <span class="comment">#规定客户端发送SQL语句时所使用的编码格式</span></span><br><span class="line">character_set_connection = <span class="string">'gbk'</span>, <span class="comment">#规定服务器接收到SQL语句后应转换为哪种编码格式后再执行</span></span><br><span class="line">character_set_results = <span class="string">'gbk'</span> <span class="comment">#规定服务器响应后返回结果集或错误信息时所使用的编码</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SQL</span>语句执行过程：首先由客户端发送<span class="keyword">SQL</span>语句，服务器端将<span class="keyword">SQL</span>语句从character_set_client转换为character_set_connection,然后进行查询；查询的结果存放到列字符集中，最后结果从列字符集转换为character_set_results,并返回到客户端。</span><br></pre></td></tr></table></figure>



</li>
</ol>
<p> <strong>原理分析：</strong></p>
<blockquote>
<p>产生宽字节注入的原因：</p>
</blockquote>
<ol>
<li><p>首先程序员为了防止SQL注入，一般会调用<code>addslashes()</code>、<code>mysql_real_escape_string()</code>、<code>mysql_escape_string()</code>这三个主要函数来将payload中的敏感字符（如单、双引号）进行转义，即在敏感字符前添加反斜杠；</p>
</li>
<li><p>当设置<code>character_set_client = &#39;gbk&#39;</code>时，会引发编码转换的问题，从而导致宽字节注入。主要原因是在使用相关的函数转义SQL语句中的特殊字符时，函数执行后，添加的反斜杠( <code>\</code> )所使用的编码格式是ASCII编码。当客户端发送SQL语句时，就会将编码转换为gbk编码。问题就出现在编码转换的过程中，<code>\</code>的URL编码为<code>%5C</code>，而当提交的payload为<code>%df%5C</code>时，经过gbk编码后会变成汉字<code>運</code>，所以说%df会将反斜杠“吃掉”，%df合并反斜杠后，导致单引号发挥闭合作用，而不仅仅是内容，从而单引号可以被利用，造成sql注入。</p>
<p><strong>注：</strong>提交的payload会先进行url编码，然后合并到SQL语句中，最后经过gbk编码后，上传到服务器 。</p>
</li>
</ol>
<p><strong>思路：</strong></p>
<ol>
<li><p>利用%df使反斜杠失去转义作用，使单引号重新发挥闭合作用；</p>
</li>
<li><p>转义反斜杠，提交<code>\&#39;</code>，利用函数转义后变成<code>\\&#39;</code>，第二个反斜杠被第一个反斜杠转义，导致单引号起到了闭合作用。但这种思路条件要求非常苛刻，因为反斜杠一般会作为特殊字符，也会被转移。</p>
<p><img src="/%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5%E5%92%8C%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5/4.png" alt="4"></p>
</li>
</ol>
<p><strong>实战（以Less-32为例）：</strong></p>
<ol>
<li><p>尝试提交<code>id=&#39;</code>，发现提示单引号被转义了；</p>
<p><img src="/%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5%E5%92%8C%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5/1.png" alt="1"></p>
</li>
<li><p>尝试使用%df让反斜杠失去转义的作用（刚开始我们并不知道编码格式是否为gbk，所以只能说是一种尝试）；提交<code>id=%df&#39;</code>，发现页面报错，并提示提交的内容变成df5c27，现在还不能完全确定反斜杠没有起作用；</p>
<p><img src="/%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5%E5%92%8C%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5/2.png" alt="2"></p>
</li>
<li><p>提交<code>id=1%df&#39;--+</code>，发现结果与提交<code>id=1</code>的结果相同，所以说单引号起到了闭合作用，也就是反斜杠失去了转义的作用，即存在宽字节注入。然后构造payload一路爆库，爆表，爆字段。</p>
<p><img src="/%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5%E5%92%8C%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5/3.png" alt="3"></p>
</li>
</ol>
<p><strong>源码分析：</strong></p>
<p><img src="/%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5%E5%92%8C%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5/5.png" alt="5"></p>
<p>自定义的<code>check_addslashes()</code>函数用于检索url中的特殊字符（例如：<code>\,&#39;</code>）。</p>
<p><a href="http://www.divcss5.com/html/h53.shtml">UTF-8 GBK UTF8 GB2312之间的区别和关系</a></p>
<p><a href="https://www.cnblogs.com/ECJTUACM-873284962/p/8747543.html">宽字节注入详解</a></p>
<h2 id="二、二次注入"><a href="#二、二次注入" class="headerlink" title="二、二次注入"></a>二、二次注入</h2><p><strong>原理分析：</strong></p>
<blockquote>
<p>一般应用程序为了防止SQL注入，会对提交到服务端的内容中的特殊字符进行过滤，常用的过滤方法是对特殊字符进行转义。但如果将提交的内容存放到数据库，那么存入数据库中的内容就不是转义后的内容，而是提交的内容。如果web应用程序从数据库中取出这个数据时，那么取出的数据就是用户第一步所提交的内容；此时，如果没有在提取数据时进行过滤，就会将用户提交的恶意数据拼接到SQL语句中，从而造成数据被泄露、修改、删除等等。这就是二次注入。</p>
</blockquote>
<p><strong>为什么不直接将转义之后的内容存入数据库呢？</strong></p>
<p>因为数据库中的部分数据是需要直接展示给用户的。当你在某网站注册成为用户时，网站就会将你的用户名、账号和密码存储在数据库中，当你登录账号时，一般会在网页上显示你的用户名，而此时的用户名，就是从数据库中取出来的。如果没有对取出的数据进行过滤，就会造成二次注入。例如，你注册的用户名为<code>admin&#39; #</code>，可能网站会检查用户名是否已被注册，就会用到SQL查询：<code>select * from users where user_name = &#39;admin&#39; #&#39;</code>，可见，如果直接将用户提交的内容拼接到SQL语句中，就会造成SQL注入。经过过滤后，SQL语句变成：<code>select * from users where user_name = &#39;admin\&#39; \#&#39;</code>，就不会造成危害。此时，如果注册成功，用户名<code>admin&#39; #</code>就会被存放到数据库中，而不是<code>admin\&#39; #&#39;</code>，当应用程序再次查询此用户时，如果没有进行过滤，SQL语句就是<code>select * from users where user_name = &#39;admin&#39; #&#39;</code>，还是会导致SQL注入，只不过这是二次注入。</p>
<p><strong>思考：</strong></p>
<p>如果直接将转义后的内容存入数据库，当查询时可以再去掉反斜杠，应该也能避免二次注入。但也有可能会拖慢程序运行，数据库不利于管理等问题。</p>
<p><strong>实战（以Less-24为例）：</strong></p>
<ol>
<li><p>首先是一个页面，具有注册、登录和修改密码的功能。往往网站功能越强大，面临的风险也就越多;</p>
<p><img src="/%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5%E5%92%8C%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5/6.png" alt="6"></p>
</li>
<li><p>先正常注册一个用户，用户名为<code>test</code>，密码为<code>123</code>；然后再查看数据库，发现用户名已被收录；</p>
<p><img src="/%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5%E5%92%8C%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5/7.png" alt="7"></p>
<p><img src="/%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5%E5%92%8C%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5/8.png" alt="8"></p>
</li>
<li><p>现在就要使用二次注入来尝试修改test账号的密码，首先注册一个用户，因为已知为单引号注入，所以设置用户名为<code>test‘ #</code>，密码随便填，这里我还是设置为<code>123</code>；</p>
<p><img src="/%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5%E5%92%8C%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5/9.png" alt="9"></p>
</li>
<li><p>登录<code>test&#39; #</code>，修改密码为<code>147</code>，然后查看数据库，发现test账号的密码变成了147。这是因为修改密码时，SQL语句为<code>UPDATE users SET passwd=&quot;147&quot; WHERE username =&#39;admin&#39; #&#39; AND
password=9562&#39;</code>，其实也就是执行了<code>UPDATE users SET passwd=&quot;147&quot; WHERE username =&#39;admin&#39;</code>，成功绕过了密码检查。</p>
<p><img src="/%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5%E5%92%8C%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5/10.png" alt="10"></p>
</li>
</ol>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-02-03T15:33:42.000Z" title="2020-02-03T15:33:42.000Z">2020-02-03</time><span class="level-item"><a class="link-muted" href="/categories/sql%E6%B3%A8%E5%85%A5/">sql注入</a></span><span class="level-item">28 分钟 读完 (大约 4172 个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/sql%E6%B3%A8%E5%85%A5%E2%80%94%E2%80%94%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5/">sql注入——普通注入</a></h1><div class="content"><h1 id="sql注入——普通注入"><a href="#sql注入——普通注入" class="headerlink" title="sql注入——普通注入"></a>sql注入——普通注入</h1><blockquote>
<p><strong>sql注入的一般思路</strong></p>
</blockquote>
<hr>
<p>一、查找注入点，判断是否存在sql注入；</p>
<blockquote>
<p>sql注入漏洞一般存在于登录、注册、修改密码入口，查找页面或添加页面等用户可以查找或修改数据的地方(一般是没有验证码的情况)；</p>
</blockquote>
<p><strong>判断方法：</strong></p>
<ol>
<li><p>单引号判断（前提是页面有错误回显）：</p>
<p>在正确的地址后面添加单引号，然后根据回显信息判断网站是否对提交的数据进行过滤。如果页面提示语法错误，则表明存在sql注入【注意前提是语法错误，因为其他的错误提示可能是检测到敏感字符而报错】。因为报语法错误就表明网站并没有对提交上去的 &#39; 进行过滤，导致我们可以任意构造sql查询语句。同时我们可以通过报错信息进一步来判断注入的类型。</p>
<p><img src="/sql%E6%B3%A8%E5%85%A5%E2%80%94%E2%80%94%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5/1.png" alt="1"></p>
<p>在上图中我们可以看到错误提示：” You have an error in your SQL syntax; “ 说明在提交的正常数据后面加上 &#39; 后导致网站后端的SQL查询语句中存在语法错误，从而判断这里存在sql注入。根据后面的提示：” check the manual that corresponds to your MySQL server version for the right syntax to use near ‘’1’’ LIMIT 0,1’ at line 1 “，可以知道产生语法错误的语句是 <code>1&#39;&#39; LIMIT 0,1</code> ， 发现是 <code>1&#39;</code> 后面多了一个我们加上去的 ‘ 导致sql语句中存在奇数个单引号而报错。如果去掉我们加上去的 &#39; 后，语句变成<code>1&#39; LIMIT 0,1</code> ,此时的语句是正确的，所以1的前面也应该有一个 &#39; 来闭合1后面的 &#39; ,从而可以判断这是字符型注入，并且猜测sql语句的可能情况：<code>SELECT * FROM database_name WHERE id = &#39;1&#39; LIMIT 0,1</code>，这时加上单引号语句就变成<code>SELECT * FROM database_name WHERE id = &#39;1&#39;&#39; LIMIT 0,1</code>从而报错。在这条报错语句中还可以判断使用的是MySQL数据库；</p>
</li>
<li><p>and判断（针对页面关闭了错误回显的情况）：</p>
<p>（以Less-1为例）首先我们注释掉PHP代码中的报错行：</p>
<p><img src="/sql%E6%B3%A8%E5%85%A5%E2%80%94%E2%80%94%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5/2.png" alt="批注 2020-01-10 111404"></p>
<p>现在当我们提交<code>id=&#39;</code>时，页面没有错误回显，那我们提交上去的单引号是被过滤掉了还是被执行了呢，没有办法直接判断，这时候就要and来帮忙了。我们先提交<code>id=1&#39; and &#39;1&#39;=&#39;1</code>或者<code>id=1&#39; and 1=1 --+</code>（下同），此时如果提交的数据被执行了的话，那么后台的SQL语句就为<code>select * from users where id=&#39;1&#39; and &#39;1&#39;=&#39;1&#39;</code>，此时条件判断为真，正常回显；</p>
<p><img src="/sql%E6%B3%A8%E5%85%A5%E2%80%94%E2%80%94%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5/3.png" alt="批注 2020-01-10 123758"></p>
<p>然后再提交<code>id=1&#39; and &#39;1&#39;=&#39;2</code>，如果提交的数据被执行，则后台的SQL语句为<code>select * from users where id=&#39;1&#39; and &#39;1&#39;=&#39;2&#39;</code>，条件判断为假，所以没有回显；</p>
<p><img src="/sql%E6%B3%A8%E5%85%A5%E2%80%94%E2%80%94%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5/4.png" alt="批注 2020-01-10 123219"></p>
<p>提交不同的数据，返回不同的结果，这说明是的<code>&#39;1&#39;=&#39;1&#39;</code>和<code>&#39;1&#39;=&#39;2&#39;</code>这两个语句起了作用，也就意味着我们提交的数据被执行了，所以存在sql注入，而且是字符型注入。这里要说清楚的是我们预先是不知道这是字符型注入的，所以我们要进行所有的尝试，直到得到我们所预期的结果。</p>
<p>我们可以尝试的语句是：</p>
<p>（1）<code>id=1&#39; and &#39;1&#39;=&#39;1</code>和<code>id=1&#39; and &#39;1&#39;=&#39;2</code>；</p>
<p>（2）<code>id=1&#39;) and (&#39;1&#39;)=(&#39;1</code>和<code>id=1&#39;) and (&#39;1&#39;)=(&#39;2</code>；</p>
<p>（3）<code>id=1 and 1=1</code>和<code>id=1 and 1=2</code>；</p>
<p>（4）<code>id=1) and (1)=(1</code>和<code>id=1) and (1)=(2</code> 。</p>
</li>
<li><p>or判断（针对页面关闭了错误回显的情况）：</p>
<p>（以Less-1为例）同样我们还是先关闭报错；提交<code>id=&#39; or 1=1 --+</code>或<code>id=&#39; or &#39;1&#39;=&#39;1</code>（下同），发现页面正常回显，此时如果提交的数据被执行了，那么SQL语句为<code>select * from users where id=&#39;1&#39; or 1=1 --+&#39; limit 0,1;</code>；</p>
<p><img src="/sql%E6%B3%A8%E5%85%A5%E2%80%94%E2%80%94%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5/5.png" alt="批注 2020-01-12 114503"></p>
<p>提交<code>id=&#39; or 1=2 --+</code>，发现页面没有回显，与提交<code>id=&#39; or 1=1 --+</code>的结果不同，这就是因为我们提交的<code>1=1</code>和<code>1=2</code>所导致的。这就证明我们提交上去的数据被插入到SQL语句中的去执行了，也就是说通过构造其他不同的payload还能执行其他不同的操作，从而获取数据。通过上述方法可以证明存在sql注入。</p>
</li>
</ol>
<p>二、如果存在sql注入，则进一步判断sql注入的类型；如果可以直接根据错误的回显信息来判断注入类型那当然更好，如果不能，就要手工输入来判断，下面主要是讲手工判断的思路。</p>
<blockquote>
<p>sql普通注入一般分为字符型和数字型。</p>
</blockquote>
<p><strong>字符型：</strong>1.<code>SELECT * FROM users WHERE id=&#39;$id&#39; LIMIT 0,1</code></p>
<p>​               2.<code>SELECT * FROM users WHERE id=(&#39;$id&#39;) LIMIT 0,1</code></p>
<p><strong>数字型：</strong>1.<code>SELECT * FROM users WHERE id=$id LIMIT 0,1</code></p>
<p>​               2.<code>SELECT * FROM users WHERE id=($id) LIMIT 0,1</code></p>
<p><strong>背景知识：</strong>在SQL语句中常用的注释：①<code>--+</code>，②<code>-- (注意两个&#39;-&#39;后面有一个空格)</code>,  ③<code>#</code>；【推荐使用–+，如果                   不知道用哪一个就都写上去：–+– #】</p>
<p><strong>判断方法(以sqli-labs-master/Less-1-4为例)：</strong></p>
<ol>
<li><p>首先正常输入<code>?id=1</code>，正常回显；</p>
<p><img src="/sql%E6%B3%A8%E5%85%A5%E2%80%94%E2%80%94%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5/6.png" alt="批注 2020-01-08 204711"></p>
</li>
<li><p>开始先尝试字符型（以Less-1为例）（先假设是字符型，然后再验证假设）：如果是字符型，则我们提交上去的<code>id=1</code>就会先变成<code>id=&#39;1&#39;</code>，然后再拼接到sql查询语句中。我们验证的思路有两种：</p>
<p>（1）第一种思路是提交<code>id=2-1</code>，如果数字型，则返回的结果和提交<code>id=1</code>是一样的，因为2-1运算后的结果还是1；如果结果不一样，则可以判断是字符型；</p>
<p>Less-1：字符型</p>
<p><img src="/sql%E6%B3%A8%E5%85%A5%E2%80%94%E2%80%94%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5/7.png" alt="批注 2020-01-08 205925"></p>
<p>Less-2：数字型</p>
<p><img src="/sql%E6%B3%A8%E5%85%A5%E2%80%94%E2%80%94%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5/8.png" alt="批注 2020-01-08 223846"></p>
<p>接下来就要判断是字符型中的哪一种（以Less-1、3为例，已经通过上述方法判断为字符型注入）：先假设是第一种，然后提交<code>id=1&#39; --+</code>；这里的思路是先用一个 &#39; 闭合1前面的单引号，然后再把后面多余的一个单引号给注释掉。如果是字符型的第一种，则返回结果与<code>id=1</code>的结果相同，否则为第二种。下面分别对Less1、3进行判断：<img src="/sql%E6%B3%A8%E5%85%A5%E2%80%94%E2%80%94%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5/9.png" alt="批注 2020-01-08 221015"></p>
<p>Less-1的返回结果与<code>id=1</code>时相同，所以为字符型的第一种；<img src="/sql%E6%B3%A8%E5%85%A5%E2%80%94%E2%80%94%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5/10.png" alt="批注 2020-01-08 221054"></p>
<p>Less-3报错，所以为字符型的第二种；同时根据错误回显可以得到应该构造<code>id=1&#39;) --+</code>提交，原理与构造<code>id=1&#39; --+</code>的原理相同；</p>
<p>（2）第二种思路是提交<code>id=1&#39; and &#39;1&#39;=&#39;1</code>，如果是字符型，则返回的结果和提交<code>id=1</code>是一样的，如果报错，则可判断为数字型。这里的思路是先用单引号闭合1前面的单引号，再借助and把1后面的单引号利用起来；</p>
<p>Less-1：字符型</p>
<p><img src="/sql%E6%B3%A8%E5%85%A5%E2%80%94%E2%80%94%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5/11.png" alt="批注 2020-01-08 224140"></p>
<p>Less-2：数字型</p>
<p><img src="/sql%E6%B3%A8%E5%85%A5%E2%80%94%E2%80%94%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5/12.png" alt="批注 2020-01-08 224315"></p>
<p>然后可以通过思路（1）中的方法判断是字符型注入的哪一种。</p>
</li>
<li><p>如果通过2中的方法判断为数字型注入，则需要再进一步判断是数字型的哪一种。当然也可以通过构造提交的数据来直接判断是否为数字型，如提交<code>id=1 --+</code>、<code>id=1) --+</code>或<code>id=1 and 1=1</code>；思路和字符型的判断思路相同。下面是判断数字型的类别的方法：提交<code>id=1) --+</code>，如果返回结果与提交<code>id=1</code>时相同，则判断为数字型的第二种；如果报错，则判断为数字型的第一种；</p>
<p>Less-2：第一种</p>
<p><img src="/sql%E6%B3%A8%E5%85%A5%E2%80%94%E2%80%94%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5/13.png" alt="批注 2020-01-08 225816"></p>
<p>Less-4：第二种</p>
<p><img src="/sql%E6%B3%A8%E5%85%A5%E2%80%94%E2%80%94%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5/14.png" alt="批注 2020-01-08 225854"></p>
</li>
</ol>
<p>三、判断具体的注入类型后，就是构造合适的payload来爆库，爆表，爆列。</p>
<blockquote>
<p>可以利用sql注入爆出数据库中几乎所有的数据。</p>
</blockquote>
<p><strong>背景知识：</strong></p>
<ul>
<li><p>在SQL语句中常用的函数：</p>
<p>（1）系统函数：version()——MySQL数据库版本；</p>
<p>​                             user()——数据库用户名；</p>
<p>​                             database()——数据库名；</p>
<p>​                             @@datadir——数据库路径；</p>
<p>​                             @@version_compile_os——操作系统版本。</p>
<p><strong><em>在dvwa中的演示结果：</em></strong></p>
<p>提交：<code>-1&#39; union select version(),user() #</code></p>
<img src="/sql%E6%B3%A8%E5%85%A5%E2%80%94%E2%80%94%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5/15.png" style="zoom:150%;">

<p>提交：<code>-1&#39; union select database(),@@datadir #</code></p>
<img src="/sql%E6%B3%A8%E5%85%A5%E2%80%94%E2%80%94%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5/16.png" style="zoom:150%;">

<p>提交：<code>-1&#39; union select @@version_compile_os,2 #</code></p>
<p>（2）字符串连接函数：</p>
<p>​            concat(str1,str2,…)——没有分隔符地连接字符串；</p>
<p>​            concat_ws(separator,str1,str2,…)——含有分隔符地连接字符串（concat_withseparator，其中separator为分隔符）；</p>
<p>​            group_concat(str1,str2,…)——连接一个组的所有字符串，并以逗号分隔每一条数据。</p>
<p><strong><em>演示结果：</em></strong></p>
<p><img src="/sql%E6%B3%A8%E5%85%A5%E2%80%94%E2%80%94%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5/17.png" alt="批注 2020-01-09 155741"></p>
<img src="/sql%E6%B3%A8%E5%85%A5%E2%80%94%E2%80%94%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5/18.png" style="zoom:200%;">



</li>
</ul>
<ul>
<li><p><strong>information_schema</strong>数据库：</p>
<blockquote>
<p>information_schema数据库是MySQL系统自带的数据库，它提供了数据库元数据的访问方式。里面包含了关于每个数据库，数据库表以及字段的信息。</p>
</blockquote>
<p><img src="/sql%E6%B3%A8%E5%85%A5%E2%80%94%E2%80%94%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5/19.png" alt="批注 2020-01-09 161502"></p>
<blockquote>
<p>sql注入中主要用到的是schemata（数据库）,tables（表）,columns（字段）这三个表；</p>
</blockquote>
<p><img src="/sql%E6%B3%A8%E5%85%A5%E2%80%94%E2%80%94%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5/20.png" alt="批注 2020-01-09 162157"></p>
<p><img src="/sql%E6%B3%A8%E5%85%A5%E2%80%94%E2%80%94%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5/21.png" alt="批注 2020-01-09 162807"></p>
<p>······（此处省略几千行）</p>
</li>
</ul>
<ul>
<li><p>常用的查询语句：</p>
<p>查询数据库：<code>select schema_name from information_schema.schemata</code>；<br>查询某数据库的数据表：<code>select table_name from information_schema.tables where table_schema=’xxx’</code>或 <code>select table_name from information_schema.tables where table_schema=database()</code>；</p>
<p>查询某数据库表的所有列：<code>Select column_name from information_schema.columns where table_name=’xxx’</code>；<br>查询某列的内容：<code>select columnname from tablename</code>。<br><strong>注：</strong>schema_name和table_scehma都是表示数据库，但schema_name是schemata表中的字段，table_schema是tables表中的字段，从上面的图中也可以看出来。</p>
</li>
</ul>
<p><strong>实战（以Less-1为例）：</strong></p>
<blockquote>
<p><strong>爆库&gt;&gt;爆表&gt;&gt;爆字段，这里要用到SQL联合查询语句union。</strong></p>
</blockquote>
<ol>
<li><p>首先要使用order by语句猜解字段。因为在使用union查询时，两边的所查询的字段要相同，也就是数据的列数要相同，如果不同就会报错：<code>The used SELECT statements have a different number of columns</code>或者没有回显内容，所以要得到字段数。如果order by后面接的是数字，那么数字是几就会对获得的数据按第几列排序，且如果数字多于一个时，会按从左到右的顺序优先排序。比如：<code>select * from users order by 2,3</code>会依次按第二列和第三列进行排序，且以第二列优先排序。当order by 后面的数字超过所获得的数据的列数时，就会报错<code>Unknown column &#39;x&#39; in &#39;order clause&#39;</code>或没有回显。</p>
<p>（1）提交：<code>id=1&#39; order by 4 --+</code> ，报错，因此字段数要小于4；</p>
<p><img src="/sql%E6%B3%A8%E5%85%A5%E2%80%94%E2%80%94%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5/22.png" alt="批注 2020-01-09 180526"></p>
<p>（2）提交：<code>id=1&#39; order by 3 --+</code>，正常回显，所以字段数为3；</p>
<p><img src="/sql%E6%B3%A8%E5%85%A5%E2%80%94%E2%80%94%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5/23.png" alt="批注 2020-01-09 180457"></p>
</li>
<li><p>得到字段数后，我们还要找出屏幕上显示的是那几个字段，因为只有显示在屏幕上我们才能得到数据；</p>
<p>提交：<code>id=-1&#39; union select 1,2,3--+</code>，发现输出的是第2,3这两列；这里将id赋值为-1是为了将前一个查询的结果置空，因为我们要显示的是后面一个查询的结果。那么为什么id=-1就能将返回的结果置空呢，是因为当 id 的数据在数据库中不存在时，返回的结果就为空，所以这里显示的就是后一个查询结果；</p>
<p><img src="/sql%E6%B3%A8%E5%85%A5%E2%80%94%E2%80%94%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5/24.png" alt="批注 2020-01-09 200132"></p>
</li>
<li><p>爆库；注意只有2,3两个字段会显示，所以想要查询的内容必须放在2,3这两个位置上；</p>
<p>提交：<code>id=-1&#39; union select 1,group_concat(schema_name),3 from information_schema.schemata --+</code></p>
<p><img src="/sql%E6%B3%A8%E5%85%A5%E2%80%94%E2%80%94%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5/25.png" alt="批注 2020-01-09 201245"></p>
<p>提交：<code>id=-1&#39; union select 1,database(),3 --+</code>，得到所需库是security；</p>
<p><img src="/sql%E6%B3%A8%E5%85%A5%E2%80%94%E2%80%94%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5/26.png" alt="批注 2020-01-09 201858"></p>
</li>
<li><p>爆表；根据第3步回显的结果得到所有数据库名，这里我们用的是数据库security（可通过查询database（）得到）；</p>
<p>提交：<code>id=-1&#39; union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=&#39;security&#39; --+</code></p>
<p><img src="/sql%E6%B3%A8%E5%85%A5%E2%80%94%E2%80%94%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5/27.png" alt="批注 2020-01-09 202411"></p>
</li>
<li><p>爆字段；这里获取users表中的数据；</p>
<p>提交：<code>id=-1&#39; union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#39;users&#39; --+</code></p>
<p><img src="/sql%E6%B3%A8%E5%85%A5%E2%80%94%E2%80%94%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5/28.png" alt="批注 2020-01-09 203044"></p>
</li>
<li><p>获取username、password字段中的数据；这里要说的是似乎其他的字段在表users中不存在，也就是表中只有username、password这两个字段，不知道是开发者本来就是这样设计的还是数据库导入的时候出错；不管怎样，只要能达到练习的目的就行；</p>
<img src="/sql%E6%B3%A8%E5%85%A5%E2%80%94%E2%80%94%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5/29.png" style="zoom:150%;">

<p>提交：<code>id=-1&#39; union select 1,group_concat(username),group_concat(password) from users --+</code></p>
<p><img src="/sql%E6%B3%A8%E5%85%A5%E2%80%94%E2%80%94%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5/30.png" alt="批注 2020-01-09 205237"></p>
<p>到这里，差不多就完成了整个sql注入过程。Less-2,Less-3,Less-4除了注入的类型不同，其他的思路基本相同。</p>
</li>
<li><p>最后我们来分析一下源码：</p>
<p><img src="/sql%E6%B3%A8%E5%85%A5%E2%80%94%E2%80%94%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5/31.png" alt="批注 2020-01-09 212532"></p>
<p>发现PHP代码并没有对我们提交的内容进行任何过滤就直接拼接到了SQL语句中，这就导致了我们提交的payload被执行，从而获得敏感的数据。PHP代码利用mysql_fetch_array()函数将查询的结果放到数组中，最后显示的内容是从数组中取出键名为’username’和’password’所对应的值。</p>
</li>
</ol>
<hr>
<p><strong>总结：</strong>在进行sql注入时，主要的思路就是剥离网站后端处理文件中的sql语句，在中间加入我们构造的payload，并想办法去执行它，从而得到我们想要的数据。在注入过程中要多动脑经，不断地去猜解后台的处理代码是什么样的，然后再根据具体情况构造合理的payload。对于其他一些稍微进行了防御的网站，我们要先弄清楚他的防御方法，然后再想办法构造payload去绕过它。还有就是sql注入的做题方法很灵活，解决问题的方法有很多，不仅限于上面思路中所给的方法。</p>
<hr>
<p><strong>在做题过程中遇到的一些问题及一些思考：</strong></p>
<ol>
<li><p>万能密码；在一些题目中，可能只需要我们输入密码，但我们并不知道密码是什么，这个时候如果存在sql注入，无论提交数据的方式是get还是post，都可使用万能密码绕过。比如：正常提交时，SQL语句为<code>select * from users where password=$_GET[&#39;password&#39;]</code>，当我们提交<code>?password=&#39;&#39; or 1=1</code>，SQL语句就变成<code>select * from users where password=&#39;&#39; or 1=1</code>，因为条件<code>password=&#39;&#39; or 1=1</code>的判断始终为真，所以能绕过密码验证，直接登录；</p>
</li>
<li><p>在做题的时候发现如果是字符型注入，则提交<code>id=2</code>和<code>id=2-1</code>的结果是一样的，也就是说验证的时候只会管第一个字符，无论后面是什么字符，当然不能是注释符了，只要开头的是2，结果都是与提交<code>id=2</code>的结果相同。</p>
<p><img src="/sql%E6%B3%A8%E5%85%A5%E2%80%94%E2%80%94%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5/32.png" alt="批注 2020-01-10 104044"></p>
<p><img src="/sql%E6%B3%A8%E5%85%A5%E2%80%94%E2%80%94%E6%99%AE%E9%80%9A%E6%B3%A8%E5%85%A5/33.png" alt="批注 2020-01-10 104121"></p>
</li>
</ol>
</div></article></div><nav class="pagination is-centered mt-4" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/page/2/">上一页</a></div><div class="pagination-next is-invisible is-hidden-mobile"><a href="/page/4/">下一页</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/">1</a></li><li><a class="pagination-link" href="/page/2/">2</a></li><li><a class="pagination-link is-current" href="/page/3/">3</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="" src="/img/avatar.png" alt="WebDog"></figure><p class="title is-size-4 is-block line-height-inherit">WebDog</p><p class="is-size-6 is-block">莫得感情的Web渗透测试机器</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>ChengDu</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">23</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">4</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">4</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/webysx" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/webysx"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><!--!--><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"><span class="level-start"><span class="level-item">php代码审计</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/python%E7%88%AC%E8%99%AB/"><span class="level-start"><span class="level-item">python爬虫</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/sql%E6%B3%A8%E5%85%A5/"><span class="level-start"><span class="level-item">sql注入</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"><span class="level-start"><span class="level-item">文件上传</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"><span class="tag">php代码审计</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/python%E7%88%AC%E8%99%AB/"><span class="tag">python爬虫</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/sql%E6%B3%A8%E5%85%A5/"><span class="tag">sql注入</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"><span class="tag">文件上传</span><span class="tag is-grey-lightest">1</span></a></div></div></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content size-small"><p><time dateTime="2020-03-30T12:42:14.000Z">2020-03-30</time></p><p class="title is-6"><a class="link-muted" href="/kali%E5%AE%89%E8%A3%85/">kali安装</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-03-28T01:58:28.000Z">2020-03-28</time></p><p class="title is-6"><a class="link-muted" href="/%E9%AA%8C%E8%AF%81%E7%A0%81%E5%AE%89%E5%85%A8/">验证码安全</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-03-25T11:07:25.000Z">2020-03-25</time></p><p class="title is-6"><a class="link-muted" href="/ctf/">ctf</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-03-25T10:10:07.000Z">2020-03-25</time></p><p class="title is-6"><a class="link-muted" href="/xxe%E6%BC%8F%E6%B4%9E/">xxe漏洞</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-03-25T10:09:15.000Z">2020-03-25</time></p><p class="title is-6"><a class="link-muted" href="/%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E/">逻辑漏洞</a></p><p class="is-uppercase"></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2020/03/"><span class="level-start"><span class="level-item">三月 2020</span></span><span class="level-end"><span class="level-item tag">15</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/02/"><span class="level-start"><span class="level-item">二月 2020</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li></ul></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="WebDog" height="28"></a><p class="size-small"><span>&copy; 2020 WebDog</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'http://yoursite.com',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>